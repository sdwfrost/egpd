<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Multivariate Discrete GPD (MDGPD) via Neural Bayes Estimation • egpd</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multivariate Discrete GPD (MDGPD) via Neural Bayes Estimation">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">egpd</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/insurance-complaints.html">Discrete EGPD Models for Insurance Complaint Counts</a></li>
    <li><a class="dropdown-item" href="../articles/doctor-visits.html">Zero-Inflated Discrete EGPD Models for Doctor Visit Counts</a></li>
    <li><a class="dropdown-item" href="../articles/gaming-offenses.html">Threshold Exceedance Modeling with DEGPD</a></li>
    <li><a class="dropdown-item" href="../articles/simulation.html">Simulation Examples</a></li>
    <li><a class="dropdown-item" href="../articles/temperature-extremes.html">Continuous EGPD Models for Temperature Extremes</a></li>
    <li><a class="dropdown-item" href="../articles/fitegpd-continuous.html">Fitting Continuous Distributions with fitegpd</a></li>
    <li><a class="dropdown-item" href="../articles/fitegpd-discrete.html">Fitting Discrete Distributions with fitegpd</a></li>
    <li><a class="dropdown-item" href="../articles/bamlss-comparison.html">Comparing egpd and bamlss Fits</a></li>
    <li><a class="dropdown-item" href="../articles/gamlss-comparison.html">Comparing egpd and gamlss Fits</a></li>
    <li><a class="dropdown-item" href="../articles/predictive-coverage.html">Predictive Coverage Assessment</a></li>
    <li><a class="dropdown-item" href="../articles/parameter-coverage.html">Parameter Estimate Coverage Assessment</a></li>
    <li><a class="dropdown-item" href="../articles/multivariate-egpd.html">Bivariate BEGPD via Neural Bayes Estimation</a></li>
    <li><a class="dropdown-item" href="../articles/bivariate-discrete-egpd.html">Bivariate Discrete EGPD via Neural Bayes Estimation</a></li>
    <li><a class="dropdown-item" href="../articles/mdgpd.html">Multivariate Discrete GPD (MDGPD) via Neural Bayes Estimation</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sdwfrost/egpd/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Multivariate Discrete GPD (MDGPD) via Neural Bayes Estimation</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sdwfrost/egpd/blob/HEAD/vignettes/mdgpd.Rmd" class="external-link"><code>vignettes/mdgpd.Rmd</code></a></small>
      <div class="d-none name"><code>mdgpd.Rmd</code></div>
    </div>

    
    
<p>The <code>egpd</code> package provides <strong>experimental</strong>
support for the Multivariate Discrete Generalized Pareto Distribution
(MDGPD) of Aka, Kratz &amp; Naveau (2025). Unlike the BDEGPD (which
discretizes continuous BEGPD samples via <code><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor()</a></code>), the
MDGPD is constructed directly in the discrete domain using a bivariate
Poisson generator and geometric maximum, yielding theoretically rigorous
discrete GPD marginals with threshold stability.</p>
<p>This vignette covers:</p>
<ol style="list-style-type: decimal">
<li>
<strong>The MDGPD construction</strong> – from Poisson generator to
discrete GPD</li>
<li>
<strong>Simulating multivariate data</strong> –
<code><a href="../reference/rmdgpd.html">rmdgpd()</a></code> and <code><a href="../reference/rzimdgpd.html">rzimdgpd()</a></code> for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>≥</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">d \geq 2</annotation></semantics></math>
dimensions</li>
<li>
<strong>Exploring parameters and dependence</strong> – the role of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ξ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math>
</li>
<li>
<strong>Higher dimensions</strong> – trivariate and beyond</li>
<li>
<strong>Neural Bayes estimation</strong> – fitting via
<code><a href="../reference/fitegpd.html">fitegpd()</a></code>
</li>
<li>
<strong>Training custom models</strong> –
<code><a href="../reference/train_mdgpd.html">train_mdgpd()</a></code>
</li>
</ol>
<div class="section level2">
<h2 id="the-mdgpd-construction">1. The MDGPD construction<a class="anchor" aria-label="anchor" href="#the-mdgpd-construction"></a>
</h2>
<div class="section level3">
<h3 id="standard-mdgpd-geometric-marginals">Standard MDGPD (geometric marginals)<a class="anchor" aria-label="anchor" href="#standard-mdgpd-geometric-marginals"></a>
</h3>
<p>The Aka-Kratz-Naveau construction builds a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>-dimensional
discrete GPD from three components:</p>
<p><strong>Step 1: Equicorrelated Poisson generator.</strong> Generate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>
correlated Poisson random variables via a common random effect:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>j</mi></msub><mo>=</mo><msub><mi>X</mi><mi>j</mi></msub><mo>+</mo><mi>Z</mi><mo>,</mo><mspace width="1.0em"></mspace><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">T_j = X_j + Z, \quad j = 1, \ldots, d</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>∼</mo><mrow><mi mathvariant="normal">P</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi></mrow><mo stretchy="false" form="prefix">(</mo><mi>ρ</mi><mi>λ</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">Z \sim \mathrm{Poisson}(\rho\lambda)</annotation></semantics></math>
is shared across all components and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>j</mi></msub><mo>∼</mo><mrow><mi mathvariant="normal">P</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi></mrow><mo stretchy="false" form="prefix">(</mo><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>ρ</mi><mo stretchy="false" form="postfix">)</mo><mi>λ</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">X_j \sim \mathrm{Poisson}((1-\rho)\lambda)</annotation></semantics></math>
are independent. The correlation between any pair
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>T</mi><mi>i</mi></msub><mo>,</mo><msub><mi>T</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(T_i, T_j)</annotation></semantics></math>
is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>.</p>
<p><strong>Step 2: Spectral differences.</strong> For each component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
compute:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Δ</mi><mi>i</mi></msub><mo>=</mo><msub><mi>T</mi><mi>i</mi></msub><mo>−</mo><munder><mi mathvariant="normal">max</mi><mrow><mi>j</mi><mo>≠</mo><mi>i</mi></mrow></munder><msub><mi>T</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">\Delta_i = T_i - \max_{j \neq i} T_j</annotation></semantics></math></p>
<p>This captures how much component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
exceeds the maximum of all others. Note that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Δ</mi><mi>i</mi></msub><mo>≤</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\Delta_i \leq 0</annotation></semantics></math>
when component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
is not the overall maximum.</p>
<p><strong>Step 3: Geometric maximum.</strong> Generate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo>∼</mo><mrow><mi mathvariant="normal">G</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">c</mi></mrow><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">G \sim \mathrm{Geometric}(1 - e^{-1})</annotation></semantics></math>,
independently of the Poisson generator.</p>
<p><strong>Step 4: Standard MDGPD.</strong> Combine:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>N</mi><mi>i</mi></msub><mo>=</mo><mi>G</mi><mo>+</mo><mrow><mi mathvariant="normal">min</mi><mo>⁡</mo></mrow><mo stretchy="false" form="prefix">(</mo><msub><mi mathvariant="normal">Δ</mi><mi>i</mi></msub><mo>,</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo><mo>,</mo><mspace width="1.0em"></mspace><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>d</mi></mrow><annotation encoding="application/x-tex">N_i = G + \min(\Delta_i, 0), \quad i = 1, \ldots, d</annotation></semantics></math></p>
<p>The resulting vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>N</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>N</mi><mi>d</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(N_1, \ldots, N_d)</annotation></semantics></math>
has geometric marginals
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">G</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\mathrm{Geom}(1 - e^{-1})</annotation></semantics></math>
and the property that
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">max</mi><mo>⁡</mo></mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>N</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>N</mi><mi>d</mi></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>G</mi></mrow><annotation encoding="application/x-tex">\max(N_1, \ldots, N_d) = G</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="non-standard-mdgpd-discrete-gpd-marginals">Non-standard MDGPD (discrete GPD marginals)<a class="anchor" aria-label="anchor" href="#non-standard-mdgpd-discrete-gpd-marginals"></a>
</h3>
<p>To obtain discrete GPD marginals with parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\sigma &gt; 0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ξ</mi><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\xi \geq 0</annotation></semantics></math>,
apply the quantile transform:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mi>i</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">⌊</mo><mfrac><mi>σ</mi><mi>ξ</mi></mfrac><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>e</mi><mrow><mi>ξ</mi><mrow><mi mathvariant="normal">max</mi><mo>⁡</mo></mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>N</mi><mi>i</mi></msub><mo>,</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo></mrow></msup><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">⌋</mo></mrow></mrow><annotation encoding="application/x-tex">M_i = \left\lfloor \frac{\sigma}{\xi}\left(e^{\xi \max(N_i, 0)} - 1\right) \right\rfloor</annotation></semantics></math></p>
<p>When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ξ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\xi = 0</annotation></semantics></math>,
this reduces to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mi>i</mi></msub><mo>=</mo><mo stretchy="false" form="prefix">⌊</mo><mi>σ</mi><msub><mi>N</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">⌋</mo></mrow><annotation encoding="application/x-tex">M_i = \lfloor \sigma N_i \rfloor</annotation></semantics></math>
(scaled geometric marginals).</p>
</div>
<div class="section level3">
<h3 id="parameter-summary">Parameter summary<a class="anchor" aria-label="anchor" href="#parameter-summary"></a>
</h3>
<table class="table">
<colgroup>
<col width="34%">
<col width="25%">
<col width="21%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th>Parameter</th>
<th>Symbol</th>
<th>Range</th>
<th>Role</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>sigma</code></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>∞</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(0, \infty)</annotation></semantics></math></td>
<td>GPD scale (marginal spread)</td>
</tr>
<tr class="even">
<td><code>xi</code></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ξ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">[</mo><mn>0</mn><mo>,</mo><mi>∞</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">[0, \infty)</annotation></semantics></math></td>
<td>GPD shape (tail heaviness)</td>
</tr>
<tr class="odd">
<td><code>lambda</code></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><mi>∞</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(0, \infty)</annotation></semantics></math></td>
<td>Poisson rate (spectral spread)</td>
</tr>
<tr class="even">
<td><code>rho</code></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">[</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">[0, 1)</annotation></semantics></math></td>
<td>Equicorrelation (dependence strength)</td>
</tr>
<tr class="odd">
<td><code>pi0</code></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>π</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\pi_0</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(0, 1)</annotation></semantics></math></td>
<td>Joint zero-inflation (ZIMDGPD only)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="simulating-data">2. Simulating data<a class="anchor" aria-label="anchor" href="#simulating-data"></a>
</h2>
<div class="section level3">
<h3 id="bivariate-mdgpd-default">Bivariate MDGPD (default)<a class="anchor" aria-label="anchor" href="#bivariate-mdgpd-default"></a>
</h3>
<p>The <code><a href="../reference/rmdgpd.html">rmdgpd()</a></code> function generates samples from the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>-dimensional
MDGPD. It is pure R and does not require Julia.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sdwfrost/egpd" class="external-link">egpd</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmdgpd.html">rmdgpd</a></span><span class="op">(</span><span class="fl">2000</span>, sigma <span class="op">=</span> <span class="fl">2</span>, xi <span class="op">=</span> <span class="fl">0.2</span>, lambda <span class="op">=</span> <span class="fl">1</span>, rho <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span></span>
<span><span class="co">#&gt;      Y1 Y2</span></span>
<span><span class="co">#&gt; [1,]  0  0</span></span>
<span><span class="co">#&gt; [2,]  0  0</span></span>
<span><span class="co">#&gt; [3,]  2  0</span></span>
<span><span class="co">#&gt; [4,]  0  0</span></span>
<span><span class="co">#&gt; [5,]  2  0</span></span>
<span><span class="co">#&gt; [6,]  0  0</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>, <span class="st">"x"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dimensions: 2000 x 2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Storage mode:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mode.html" class="external-link">storage.mode</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Storage mode: integer</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Range Y1:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="st">"  Range Y2:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Range Y1: 0 39   Range Y2: 0 30</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/jitter.html" class="external-link">jitter</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/jitter.html" class="external-link">jitter</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Simulated bivariate MDGPD (jittered)"</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="mdgpd_files/figure-html/scatter-basic-1.png" class="r-plt" alt="" width="672"></p>
</div>
<div class="section level3">
<h3 id="marginal-distributions">Marginal distributions<a class="anchor" aria-label="anchor" href="#marginal-distributions"></a>
</h3>
<p>The marginals of the non-standard MDGPD are discrete GPD. When
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sigma = 1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ξ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\xi = 0</annotation></semantics></math>,
they reduce to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">G</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\mathrm{Geom}(1 - e^{-1})</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">Y_geom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmdgpd.html">rmdgpd</a></span><span class="op">(</span><span class="fl">5000</span>, sigma <span class="op">=</span> <span class="fl">1</span>, xi <span class="op">=</span> <span class="fl">0</span>, lambda <span class="op">=</span> <span class="fl">1</span>, rho <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">Y_geom</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Y_geom</span><span class="op">)</span>,</span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Marginal "</span> <span class="op">*</span> <span class="va">Y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="st">" (sigma=1, xi=0)"</span><span class="op">)</span>,</span>
<span>        xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"Proportion"</span>,</span>
<span>        col <span class="op">=</span> <span class="st">"lightblue"</span>, border <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Overlay theoretical Geom(1-e^{-1})</span></span>
<span><span class="va">p_geom</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">k_vals</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">Y_geom</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">k_vals</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Geometric.html" class="external-link">dgeom</a></span><span class="op">(</span><span class="va">k_vals</span>, prob <span class="op">=</span> <span class="va">p_geom</span><span class="op">)</span>,</span>
<span>       pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, <span class="st">"Geom(1-e^{-1})"</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>       cex <span class="op">=</span> <span class="fl">0.8</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## With sigma=2, xi=0.2: heavier tails</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span>,</span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Marginal "</span> <span class="op">*</span> <span class="va">Y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="st">" (sigma=2, xi=0.2)"</span><span class="op">)</span>,</span>
<span>        xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"Proportion"</span>,</span>
<span>        col <span class="op">=</span> <span class="st">"lightblue"</span>, border <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span></code></pre></div>
<p><img src="mdgpd_files/figure-html/marginals-1.png" class="r-plt" alt="" width="768"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="maximum-component-is-geometric">Maximum component is geometric<a class="anchor" aria-label="anchor" href="#maximum-component-is-geometric"></a>
</h3>
<p>A key theoretical property: the component-wise maximum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mi mathvariant="normal">max</mi><mo>⁡</mo></mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>N</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>N</mi><mi>d</mi></msub><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>G</mi><mo>∼</mo><mrow><mi mathvariant="normal">G</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">m</mi></mrow><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\max(N_1, \ldots, N_d) = G \sim \mathrm{Geom}(1-e^{-1})</annotation></semantics></math>.
We verify this for the standard MDGPD
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sigma=1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ξ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\xi=0</annotation></semantics></math>):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">maxY</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">Y_geom</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">Y_geom</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">maxY</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">maxY</span><span class="op">)</span>,</span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"max("</span> <span class="op">*</span> <span class="va">Y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="st">", "</span> <span class="op">*</span> <span class="va">Y</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="st">") vs Geom(1-"</span> <span class="op">*</span> <span class="va">e</span><span class="op">^</span><span class="op">{</span><span class="op">-</span><span class="fl">1</span><span class="op">}</span> <span class="op">*</span> <span class="st">")"</span><span class="op">)</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"max(Y1, Y2)"</span>, ylab <span class="op">=</span> <span class="st">"Proportion"</span>,</span>
<span>        col <span class="op">=</span> <span class="st">"lightblue"</span>, border <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span>
<span><span class="va">k_max</span> <span class="op">&lt;-</span> <span class="fl">0</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">maxY</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">k_max</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Geometric.html" class="external-link">dgeom</a></span><span class="op">(</span><span class="va">k_max</span>, prob <span class="op">=</span> <span class="va">p_geom</span><span class="op">)</span>,</span>
<span>       pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"red"</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, <span class="st">"Geom(1-e^{-1})"</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>       cex <span class="op">=</span> <span class="fl">0.8</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span></code></pre></div>
<p><img src="mdgpd_files/figure-html/max-geom-1.png" class="r-plt" alt="" width="672"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Empirical mean of max:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">maxY</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Empirical mean of max: 0.578</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Theoretical mean:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Theoretical mean: 0.582</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="zero-inflated-mdgpd">Zero-inflated MDGPD<a class="anchor" aria-label="anchor" href="#zero-inflated-mdgpd"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">Y_zi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rzimdgpd.html">rzimdgpd</a></span><span class="op">(</span><span class="fl">2000</span>, sigma <span class="op">=</span> <span class="fl">2</span>, xi <span class="op">=</span> <span class="fl">0.2</span>, lambda <span class="op">=</span> <span class="fl">1</span>, rho <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                  pi0 <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">joint_zeros</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">Y_zi</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Proportion of all-zero rows:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">joint_zeros</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Proportion of all-zero rows: 0.754</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"(Expected &gt;= pi0 = 0.3 due to natural zeros)\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; (Expected &gt;= pi0 = 0.3 due to natural zeros)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="the-role-of-parameters">3. The role of parameters<a class="anchor" aria-label="anchor" href="#the-role-of-parameters"></a>
</h2>
<div class="section level3">
<h3 id="dependence-strength-rho">Dependence strength
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>)<a class="anchor" aria-label="anchor" href="#dependence-strength-rho"></a>
</h3>
<p>The parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
directly controls the equicorrelation of the Poisson generator. Higher
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
means the common component
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>
dominates, making all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>T</mi><mi>j</mi></msub><annotation encoding="application/x-tex">T_j</annotation></semantics></math>
nearly identical and thus producing near-identical
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">(</mo><msub><mi>Y</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>Y</mi><mi>d</mi></msub><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(Y_1, \ldots, Y_d)</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">n_demo</span> <span class="op">&lt;-</span> <span class="fl">3000</span></span>
<span></span>
<span><span class="va">rho_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.3</span>, <span class="fl">0.7</span>, <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">rho_v</span> <span class="kw">in</span> <span class="va">rho_vals</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">Y_rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmdgpd.html">rmdgpd</a></span><span class="op">(</span><span class="va">n_demo</span>, sigma <span class="op">=</span> <span class="fl">2</span>, xi <span class="op">=</span> <span class="fl">0.2</span>, lambda <span class="op">=</span> <span class="fl">1</span>, rho <span class="op">=</span> <span class="va">rho_v</span><span class="op">)</span></span>
<span>  <span class="va">cor_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">Y_rho</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">Y_rho</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/jitter.html" class="external-link">jitter</a></span><span class="op">(</span><span class="va">Y_rho</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/jitter.html" class="external-link">jitter</a></span><span class="op">(</span><span class="va">Y_rho</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>       main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="va">rho</span> <span class="op">==</span> <span class="fu">.</span><span class="op">(</span><span class="va">rho_v</span><span class="op">)</span> <span class="op">~</span> <span class="st">" (cor = "</span> <span class="op">*</span> <span class="fu">.</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cor_val</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="st">")"</span><span class="op">)</span>,</span>
<span>       xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="mdgpd_files/figure-html/rho-effect-1.png" class="r-plt" alt="" width="768"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="spectral-spread-lambda">Spectral spread
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>)<a class="anchor" aria-label="anchor" href="#spectral-spread-lambda"></a>
</h3>
<p>The parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
controls the Poisson rate. Larger
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
produces larger spectral differences
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi mathvariant="normal">Δ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\Delta_i</annotation></semantics></math>,
which in turn makes the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>N</mi><mi>i</mi></msub><annotation encoding="application/x-tex">N_i</annotation></semantics></math>
more variable relative to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lambda_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">lam_v</span> <span class="kw">in</span> <span class="va">lambda_vals</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">Y_lam</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmdgpd.html">rmdgpd</a></span><span class="op">(</span><span class="va">n_demo</span>, sigma <span class="op">=</span> <span class="fl">2</span>, xi <span class="op">=</span> <span class="fl">0.2</span>, lambda <span class="op">=</span> <span class="va">lam_v</span>, rho <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="va">cor_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">Y_lam</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>, <span class="va">Y_lam</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/jitter.html" class="external-link">jitter</a></span><span class="op">(</span><span class="va">Y_lam</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/jitter.html" class="external-link">jitter</a></span><span class="op">(</span><span class="va">Y_lam</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>       main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="va">lambda</span> <span class="op">==</span> <span class="fu">.</span><span class="op">(</span><span class="va">lam_v</span><span class="op">)</span> <span class="op">~</span> <span class="st">" (cor = "</span> <span class="op">*</span> <span class="fu">.</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">cor_val</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="st">")"</span><span class="op">)</span>,</span>
<span>       xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="mdgpd_files/figure-html/lambda-effect-1.png" class="r-plt" alt="" width="768"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="tail-heaviness-xi">Tail heaviness
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ξ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math>)<a class="anchor" aria-label="anchor" href="#tail-heaviness-xi"></a>
</h3>
<p>The shape parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ξ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math>
controls the tail behaviour. Larger
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ξ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math>
produces heavier tails (occasional very large values):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="va">xi_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">xi_v</span> <span class="kw">in</span> <span class="va">xi_vals</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">Y_xi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmdgpd.html">rmdgpd</a></span><span class="op">(</span><span class="va">n_demo</span>, sigma <span class="op">=</span> <span class="fl">2</span>, xi <span class="op">=</span> <span class="va">xi_v</span>, lambda <span class="op">=</span> <span class="fl">1</span>, rho <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/jitter.html" class="external-link">jitter</a></span><span class="op">(</span><span class="va">Y_xi</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/jitter.html" class="external-link">jitter</a></span><span class="op">(</span><span class="va">Y_xi</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>       main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/bquote.html" class="external-link">bquote</a></span><span class="op">(</span><span class="va">xi</span> <span class="op">==</span> <span class="fu">.</span><span class="op">(</span><span class="va">xi_v</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="mdgpd_files/figure-html/xi-effect-1.png" class="r-plt" alt="" width="768"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="higher-dimensions">4. Higher dimensions<a class="anchor" aria-label="anchor" href="#higher-dimensions"></a>
</h2>
<p>The MDGPD generalises naturally to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>≥</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">d \geq 2</annotation></semantics></math>
dimensions. Simply pass the <code>d</code> parameter to
<code><a href="../reference/rmdgpd.html">rmdgpd()</a></code>:</p>
<div class="section level3">
<h3 id="trivariate-mdgpd-d-3">Trivariate MDGPD
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">d = 3</annotation></semantics></math>)<a class="anchor" aria-label="anchor" href="#trivariate-mdgpd-d-3"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Y3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmdgpd.html">rmdgpd</a></span><span class="op">(</span><span class="fl">2000</span>, sigma <span class="op">=</span> <span class="fl">2</span>, xi <span class="op">=</span> <span class="fl">0.2</span>, lambda <span class="op">=</span> <span class="fl">1</span>, rho <span class="op">=</span> <span class="fl">0.5</span>, d <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Dimensions:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Y3</span><span class="op">)</span>, <span class="st">"x"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Y3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Dimensions: 2000 x 3</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Column names:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Y3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Column names: Y1 Y2 Y3</span></span>
<span></span>
<span><span class="co">## Pairwise scatter plots</span></span>
<span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pairs_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">pr</span> <span class="kw">in</span> <span class="va">pairs_list</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/jitter.html" class="external-link">jitter</a></span><span class="op">(</span><span class="va">Y3</span><span class="op">[</span>, <span class="va">pr</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/jitter.html" class="external-link">jitter</a></span><span class="op">(</span><span class="va">Y3</span><span class="op">[</span>, <span class="va">pr</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>       main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Y"</span>, <span class="va">pr</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">" vs Y"</span>, <span class="va">pr</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>       xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Y"</span>, <span class="va">pr</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Y"</span>, <span class="va">pr</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="mdgpd_files/figure-html/trivariate-1.png" class="r-plt" alt="" width="768"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pairwise-correlation-in-d-3">Pairwise correlation in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">d = 3</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#pairwise-correlation-in-d-3"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Pairwise correlations:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Pairwise correlations:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">Y3</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Y1    Y2    Y3</span></span>
<span><span class="co">#&gt; Y1 1.000 0.875 0.871</span></span>
<span><span class="co">#&gt; Y2 0.875 1.000 0.853</span></span>
<span><span class="co">#&gt; Y3 0.871 0.853 1.000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="dependence-at-high-rho-in-d-3">Dependence at high
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">d = 3</annotation></semantics></math><a class="anchor" aria-label="anchor" href="#dependence-at-high-rho-in-d-3"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">Y3_high</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmdgpd.html">rmdgpd</a></span><span class="op">(</span><span class="fl">2000</span>, sigma <span class="op">=</span> <span class="fl">2</span>, xi <span class="op">=</span> <span class="fl">0.2</span>, lambda <span class="op">=</span> <span class="fl">1</span>, rho <span class="op">=</span> <span class="fl">0.95</span>, d <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">pr</span> <span class="kw">in</span> <span class="va">pairs_list</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/jitter.html" class="external-link">jitter</a></span><span class="op">(</span><span class="va">Y3_high</span><span class="op">[</span>, <span class="va">pr</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/jitter.html" class="external-link">jitter</a></span><span class="op">(</span><span class="va">Y3_high</span><span class="op">[</span>, <span class="va">pr</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>       main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Y"</span>, <span class="va">pr</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">" vs Y"</span>, <span class="va">pr</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="st">" (rho=0.95)"</span><span class="op">)</span>,</span>
<span>       xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Y"</span>, <span class="va">pr</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Y"</span>, <span class="va">pr</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="mdgpd_files/figure-html/trivariate-high-rho-1.png" class="r-plt" alt="" width="768"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Pairwise correlations (rho=0.95):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Pairwise correlations (rho=0.95):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">Y3_high</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Y1    Y2    Y3</span></span>
<span><span class="co">#&gt; Y1 1.000 0.988 0.986</span></span>
<span><span class="co">#&gt; Y2 0.988 1.000 0.982</span></span>
<span><span class="co">#&gt; Y3 0.986 0.982 1.000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="even-higher-dimensions">Even higher dimensions<a class="anchor" aria-label="anchor" href="#even-higher-dimensions"></a>
</h3>
<p>The construction works for any
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>≥</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">d \geq 2</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Y5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmdgpd.html">rmdgpd</a></span><span class="op">(</span><span class="fl">1000</span>, sigma <span class="op">=</span> <span class="fl">2</span>, xi <span class="op">=</span> <span class="fl">0.2</span>, lambda <span class="op">=</span> <span class="fl">1</span>, rho <span class="op">=</span> <span class="fl">0.5</span>, d <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"5-dimensional MDGPD:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Y5</span><span class="op">)</span>, <span class="st">"x"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">Y5</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 5-dimensional MDGPD: 1000 x 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Columns:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">Y5</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Columns: Y1 Y2 Y3 Y4 Y5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nPairwise correlations:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Pairwise correlations:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">Y5</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Y1    Y2    Y3    Y4    Y5</span></span>
<span><span class="co">#&gt; Y1 1.000 0.823 0.831 0.836 0.821</span></span>
<span><span class="co">#&gt; Y2 0.823 1.000 0.827 0.821 0.831</span></span>
<span><span class="co">#&gt; Y3 0.831 0.827 1.000 0.788 0.813</span></span>
<span><span class="co">#&gt; Y4 0.836 0.821 0.788 1.000 0.841</span></span>
<span><span class="co">#&gt; Y5 0.821 0.831 0.813 0.841 1.000</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="zero-inflated-mdgpd-in-higher-dimensions">5. Zero-inflated MDGPD in higher dimensions<a class="anchor" aria-label="anchor" href="#zero-inflated-mdgpd-in-higher-dimensions"></a>
</h2>
<p>The <code><a href="../reference/rzimdgpd.html">rzimdgpd()</a></code> function also supports arbitrary
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">Y3_zi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rzimdgpd.html">rzimdgpd</a></span><span class="op">(</span><span class="fl">2000</span>, sigma <span class="op">=</span> <span class="fl">2</span>, xi <span class="op">=</span> <span class="fl">0.2</span>, lambda <span class="op">=</span> <span class="fl">1</span>, rho <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                    pi0 <span class="op">=</span> <span class="fl">0.3</span>, d <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">joint_zeros_3d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">Y3_zi</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Proportion of all-zero rows (d=3):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">joint_zeros_3d</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Proportion of all-zero rows (d=3): 0.744</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="neural-bayes-estimation">6. Neural Bayes estimation<a class="anchor" aria-label="anchor" href="#neural-bayes-estimation"></a>
</h2>
<div class="section level3">
<h3 id="fitting-bivariate-mdgpd">Fitting bivariate MDGPD<a class="anchor" aria-label="anchor" href="#fitting-bivariate-mdgpd"></a>
</h3>
<p>The MDGPD has no closed-form likelihood (the construction involves a
discrete maximum and floor operations). Neural Bayes estimation is used
instead, via pre-trained neural networks.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmdgpd.html">rmdgpd</a></span><span class="op">(</span><span class="fl">1000</span>, sigma <span class="op">=</span> <span class="fl">2</span>, xi <span class="op">=</span> <span class="fl">0.2</span>, lambda <span class="op">=</span> <span class="fl">1</span>, rho <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitegpd.html">fitegpd</a></span><span class="op">(</span><span class="va">Y</span>, family <span class="op">=</span> <span class="st">"mdgpd"</span>, method <span class="op">=</span> <span class="st">"neuralbayes"</span>,</span>
<span>               estimator <span class="op">=</span> <span class="st">"npe"</span>, nsamples <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span></span>
<span><span class="co">#&gt; Starting Julia ...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fitting of bivariate MDGPD (Aka-Kratz-Naveau) [Experimental]</span></span>
<span><span class="co">#&gt; Method: neuralbayes (npe)  [2000 posterior samples]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Posterior summary:</span></span>
<span><span class="co">#&gt;        Median Post.SD   2.5%  97.5%</span></span>
<span><span class="co">#&gt; sigma  2.0373  0.2556 1.5729 2.5548</span></span>
<span><span class="co">#&gt; xi     0.2339  0.1408 0.0238 0.5114</span></span>
<span><span class="co">#&gt; lambda 1.4712  1.2878 0.4035 4.9281</span></span>
<span><span class="co">#&gt; rho    0.6811  0.2611 0.0666 0.9148</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Note: log-likelihood, AIC, and BIC are not available for neural estimation</span></span>
<span><span class="co">#&gt; Number of observations:  1000</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="mdgpd_files/figure-html/fit-mdgpd-diagnostics-1.png" class="r-plt" alt="" width="768"></p>
</div>
<div class="section level3">
<h3 id="fitting-zimdgpd">Fitting ZIMDGPD<a class="anchor" aria-label="anchor" href="#fitting-zimdgpd"></a>
</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Y_zi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rzimdgpd.html">rzimdgpd</a></span><span class="op">(</span><span class="fl">1000</span>, sigma <span class="op">=</span> <span class="fl">2</span>, xi <span class="op">=</span> <span class="fl">0.2</span>, lambda <span class="op">=</span> <span class="fl">1</span>, rho <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                  pi0 <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="va">fit_zi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitegpd.html">fitegpd</a></span><span class="op">(</span><span class="va">Y_zi</span>, family <span class="op">=</span> <span class="st">"zimdgpd"</span>, method <span class="op">=</span> <span class="st">"neuralbayes"</span>,</span>
<span>                   estimator <span class="op">=</span> <span class="st">"npe"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_zi</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fitting of zero-inflated bivariate MDGPD (ZIMDGPD) [Experimental]</span></span>
<span><span class="co">#&gt; Method: neuralbayes (npe)  [1000 posterior samples]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Posterior summary:</span></span>
<span><span class="co">#&gt;        Median Post.SD   2.5%  97.5%</span></span>
<span><span class="co">#&gt; sigma  1.7381  0.2975 1.2077 2.3554</span></span>
<span><span class="co">#&gt; xi     0.2191  0.1212 0.0162 0.4268</span></span>
<span><span class="co">#&gt; lambda 1.6117  1.1618 0.3807 4.7926</span></span>
<span><span class="co">#&gt; rho    0.6366  0.2383 0.0965 0.9081</span></span>
<span><span class="co">#&gt; pi0    0.2503  0.1101 0.0482 0.4624</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Note: log-likelihood, AIC, and BIC are not available for neural estimation</span></span>
<span><span class="co">#&gt; Number of observations:  1000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="s3-methods">S3 methods<a class="anchor" aria-label="anchor" href="#s3-methods"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>                <span class="co"># Posterior median estimates</span></span>
<span><span class="co">#&gt;    sigma       xi   lambda      rho </span></span>
<span><span class="co">#&gt; 2.037282 0.233938 1.471153 0.681051</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>             <span class="co"># 95% credible intervals</span></span>
<span><span class="co">#&gt;             2.5 %    97.5 %</span></span>
<span><span class="co">#&gt; sigma  1.57288426 2.5547769</span></span>
<span><span class="co">#&gt; xi     0.02377782 0.5114318</span></span>
<span><span class="co">#&gt; lambda 0.40350734 4.9280589</span></span>
<span><span class="co">#&gt; rho    0.06656750 0.9148393</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>                <span class="co"># Posterior covariance matrix</span></span>
<span><span class="co">#&gt;                sigma           xi       lambda          rho</span></span>
<span><span class="co">#&gt; sigma   0.0653121330 -0.024736149 -0.005829067 0.0005754695</span></span>
<span><span class="co">#&gt; xi     -0.0247361487  0.019833619  0.012748590 0.0028251108</span></span>
<span><span class="co">#&gt; lambda -0.0058290666  0.012748590  1.658399252 0.2762968616</span></span>
<span><span class="co">#&gt; rho     0.0005754695  0.002825111  0.276296862 0.0681657652</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/nobs.html" class="external-link">nobs</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>                <span class="co"># Number of observations</span></span>
<span><span class="co">#&gt; [1] 1000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="higher-dimensional-estimation">Higher-dimensional estimation<a class="anchor" aria-label="anchor" href="#higher-dimensional-estimation"></a>
</h3>
<p>For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>≥</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">d \geq 3</annotation></semantics></math>,
a separate neural network must be trained for each data dimension, since
the network architecture depends on the input dimension. Use
<code><a href="../reference/train_mdgpd.html">train_mdgpd()</a></code> with the <code>data_dim</code> parameter:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit 3D data using a pre-trained model</span></span>
<span><span class="va">Y3_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmdgpd.html">rmdgpd</a></span><span class="op">(</span><span class="fl">1000</span>, sigma <span class="op">=</span> <span class="fl">2</span>, xi <span class="op">=</span> <span class="fl">0.2</span>, lambda <span class="op">=</span> <span class="fl">1</span>, rho <span class="op">=</span> <span class="fl">0.5</span>, d <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_3d_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"models"</span>, <span class="st">"MDGPD_3D_NPE.bson"</span>, package <span class="op">=</span> <span class="st">"egpd"</span><span class="op">)</span></span>
<span><span class="va">fit_3d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitegpd.html">fitegpd</a></span><span class="op">(</span><span class="va">Y3_fit</span>, family <span class="op">=</span> <span class="st">"mdgpd"</span>, method <span class="op">=</span> <span class="st">"neuralbayes"</span>,</span>
<span>                   model.path <span class="op">=</span> <span class="va">model_3d_path</span>, estimator <span class="op">=</span> <span class="st">"npe"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_3d</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fitting of 3-variate MDGPD (Aka-Kratz-Naveau) [Experimental]</span></span>
<span><span class="co">#&gt; Method: neuralbayes (npe)  [1000 posterior samples]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Posterior summary:</span></span>
<span><span class="co">#&gt;        Median Post.SD   2.5%  97.5%</span></span>
<span><span class="co">#&gt; sigma  1.8967  0.2849 1.3838 2.4651</span></span>
<span><span class="co">#&gt; xi     0.1942  0.1274 0.0143 0.4506</span></span>
<span><span class="co">#&gt; lambda 1.4899  1.2285 0.4130 4.9407</span></span>
<span><span class="co">#&gt; rho    0.6957  0.2439 0.0907 0.9179</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Note: log-likelihood, AIC, and BIC are not available for neural estimation</span></span>
<span><span class="co">#&gt; Number of observations:  1000</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="comparison-mdgpd-vs-bdegpd">7. Comparison: MDGPD vs BDEGPD<a class="anchor" aria-label="anchor" href="#comparison-mdgpd-vs-bdegpd"></a>
</h2>
<p>The package provides two approaches to bivariate discrete extreme
value modelling. They are suited to different settings:</p>
<table class="table">
<colgroup>
<col width="34%">
<col width="34%">
<col width="30%">
</colgroup>
<thead><tr class="header">
<th>Aspect</th>
<th>BDEGPD</th>
<th>MDGPD</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Construction</td>
<td><code>floor(continuous BEGPD)</code></td>
<td>Poisson generator + geometric max</td>
</tr>
<tr class="even">
<td>Theoretical basis</td>
<td>Ad hoc discretization</td>
<td>Threshold-stable discrete GPD</td>
</tr>
<tr class="odd">
<td>Parameters</td>
<td>6
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>κ</mi><mo>,</mo><mi>σ</mi><mo>,</mo><mi>ξ</mi><mo>,</mo><msub><mi>θ</mi><mi>L</mi></msub><mo>,</mo><msub><mi>θ</mi><mi>U</mi></msub><mo>,</mo><msub><mi>θ</mi><mi>ω</mi></msub></mrow><annotation encoding="application/x-tex">\kappa, \sigma, \xi, \theta_L, \theta_U, \theta_\omega</annotation></semantics></math>)</td>
<td>4
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>,</mo><mi>ξ</mi><mo>,</mo><mi>λ</mi><mo>,</mo><mi>ρ</mi></mrow><annotation encoding="application/x-tex">\sigma, \xi, \lambda, \rho</annotation></semantics></math>)</td>
</tr>
<tr class="even">
<td>Dependence</td>
<td>Asymmetric (separate lower/upper tail)</td>
<td>Exchangeable (equicorrelated)</td>
</tr>
<tr class="odd">
<td>Dimensions</td>
<td>2 only</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>≥</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">d \geq 2</annotation></semantics></math></td>
</tr>
<tr class="even">
<td>Marginals</td>
<td>Discrete EGPD</td>
<td>Discrete GPD</td>
</tr>
<tr class="odd">
<td>Threshold stability</td>
<td>Not guaranteed</td>
<td>Yes (by construction)</td>
</tr>
</tbody>
</table>
<p><strong>When to use BDEGPD:</strong> When the data exhibit asymmetric
dependence between lower and upper tails, or when you want to directly
compare continuous and discrete BEGPD fits with the same parameter
set.</p>
<p><strong>When to use MDGPD:</strong> When you want a parsimonious
model with theoretical threshold stability, exchangeable dependence, and
the ability to extend to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>d</mi><mo>&gt;</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">d &gt; 2</annotation></semantics></math>
dimensions.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span><span class="va">n_cmp</span> <span class="op">&lt;-</span> <span class="fl">3000</span></span>
<span></span>
<span><span class="va">Y_bdegpd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rbdegpd.html">rbdegpd</a></span><span class="op">(</span><span class="va">n_cmp</span>, kappa <span class="op">=</span> <span class="fl">2</span>, sigma <span class="op">=</span> <span class="fl">1.5</span>, xi <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                     thL <span class="op">=</span> <span class="fl">3</span>, thU <span class="op">=</span> <span class="fl">3</span>, thw <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="va">Y_mdgpd</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rmdgpd.html">rmdgpd</a></span><span class="op">(</span><span class="va">n_cmp</span>, sigma <span class="op">=</span> <span class="fl">2</span>, xi <span class="op">=</span> <span class="fl">0.2</span>, lambda <span class="op">=</span> <span class="fl">1</span>, rho <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/jitter.html" class="external-link">jitter</a></span><span class="op">(</span><span class="va">Y_bdegpd</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/jitter.html" class="external-link">jitter</a></span><span class="op">(</span><span class="va">Y_bdegpd</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"BDEGPD (6 params)"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/jitter.html" class="external-link">jitter</a></span><span class="op">(</span><span class="va">Y_mdgpd</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/jitter.html" class="external-link">jitter</a></span><span class="op">(</span><span class="va">Y_mdgpd</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fl">20</span>, cex <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"MDGPD (4 params)"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"firebrick"</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="mdgpd_files/figure-html/compare-1.png" class="r-plt" alt="" width="768"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="training-custom-models">8. Training custom models<a class="anchor" aria-label="anchor" href="#training-custom-models"></a>
</h2>
<div class="section level3">
<h3 id="mdgpd-training">MDGPD training<a class="anchor" aria-label="anchor" href="#mdgpd-training"></a>
</h3>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Quick training for 2D MDGPD</span></span>
<span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/train_mdgpd.html">train_mdgpd</a></span><span class="op">(</span></span>
<span>  savepath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"mdgpd"</span>,</span>
<span>  data_dim <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  estimator <span class="op">=</span> <span class="st">"both"</span>,</span>
<span>  quick <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Quick training for 3D MDGPD</span></span>
<span><span class="va">paths_3d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/train_mdgpd.html">train_mdgpd</a></span><span class="op">(</span></span>
<span>  savepath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"mdgpd"</span>,</span>
<span>  data_dim <span class="op">=</span> <span class="fl">3L</span>,</span>
<span>  estimator <span class="op">=</span> <span class="st">"npe"</span>,</span>
<span>  quick <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ZIMDGPD training</span></span>
<span><span class="va">paths_zi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/train_mdgpd.html">train_mdgpd</a></span><span class="op">(</span></span>
<span>  savepath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"zimdgpd"</span>,</span>
<span>  data_dim <span class="op">=</span> <span class="fl">2L</span>,</span>
<span>  estimator <span class="op">=</span> <span class="st">"npe"</span>,</span>
<span>  quick <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="prior-distributions">Prior distributions<a class="anchor" aria-label="anchor" href="#prior-distributions"></a>
</h3>
<p>The training procedure samples parameters from the following
priors:</p>
<table class="table">
<thead><tr class="header">
<th>Parameter</th>
<th>Prior</th>
<th>Transform</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>σ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo stretchy="false" form="prefix">(</mo><mn>0.1</mn><mo>,</mo><mn>10</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">U(0.1, 10)</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi mathvariant="normal">log</mi><annotation encoding="application/x-tex">\log</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ξ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo stretchy="false" form="prefix">(</mo><mn>0.01</mn><mo>,</mo><mn>0.5</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">U(0.01, 0.5)</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi mathvariant="normal">log</mi><annotation encoding="application/x-tex">\log</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo stretchy="false" form="prefix">(</mo><mn>0.01</mn><mo>,</mo><mn>5</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">U(0.01, 5)</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi mathvariant="normal">log</mi><annotation encoding="application/x-tex">\log</annotation></semantics></math></td>
</tr>
<tr class="even">
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo stretchy="false" form="prefix">(</mo><mn>0.01</mn><mo>,</mo><mn>0.99</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">U(0.01, 0.99)</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><annotation encoding="application/x-tex">\mathrm{logit}</annotation></semantics></math></td>
</tr>
<tr class="odd">
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>π</mi><mn>0</mn></msub><annotation encoding="application/x-tex">\pi_0</annotation></semantics></math>
(ZIMDGPD)</td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo stretchy="false" form="prefix">(</mo><mn>0.01</mn><mo>,</mo><mn>0.9</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">U(0.01, 0.9)</annotation></semantics></math></td>
<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">l</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">g</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">t</mi></mrow><annotation encoding="application/x-tex">\mathrm{logit}</annotation></semantics></math></td>
</tr>
</tbody>
</table>
<p>Model files are named with a dimension-specific prefix:
<code>MDGPD_NPE.bson</code> (2D), <code>MDGPD3D_NPE.bson</code> (3D),
etc.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Aka, S., Kratz, M., and Naveau, P. (2025). Multivariate discrete
generalized Pareto distributions: theory, simulation, and applications
to dry spells. <em>arXiv preprint</em> arXiv:2506.19361. <a href="https://arxiv.org/abs/2506.19361" class="external-link uri">https://arxiv.org/abs/2506.19361</a></p>
<p>Sainsbury-Dale, M., Zammit-Mangion, A., and Huser, R. (2024).
Likelihood-free parameter estimation with neural Bayes estimators.
<em>The American Statistician</em>, 78(1), 1–14.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Touqeer Ahmad, Simon Frost.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
