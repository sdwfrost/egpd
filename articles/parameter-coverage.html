<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Parameter Estimate Coverage Assessment â€¢ egpd</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Parameter Estimate Coverage Assessment">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">egpd</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/insurance-complaints.html">Discrete EGPD Models for Insurance Complaint Counts</a></li>
    <li><a class="dropdown-item" href="../articles/doctor-visits.html">Zero-Inflated Discrete EGPD Models for Doctor Visit Counts</a></li>
    <li><a class="dropdown-item" href="../articles/gaming-offenses.html">Threshold Exceedance Modeling with DEGPD</a></li>
    <li><a class="dropdown-item" href="../articles/simulation.html">Simulation Examples</a></li>
    <li><a class="dropdown-item" href="../articles/temperature-extremes.html">Continuous EGPD Models for Temperature Extremes</a></li>
    <li><a class="dropdown-item" href="../articles/fitegpd-continuous.html">Fitting Continuous Distributions with fitegpd</a></li>
    <li><a class="dropdown-item" href="../articles/fitegpd-discrete.html">Fitting Discrete Distributions with fitegpd</a></li>
    <li><a class="dropdown-item" href="../articles/bamlss-comparison.html">Comparing egpd and bamlss Fits</a></li>
    <li><a class="dropdown-item" href="../articles/gamlss-comparison.html">Comparing egpd and gamlss Fits</a></li>
    <li><a class="dropdown-item" href="../articles/predictive-coverage.html">Predictive Coverage Assessment</a></li>
    <li><a class="dropdown-item" href="../articles/parameter-coverage.html">Parameter Estimate Coverage Assessment</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sdwfrost/egpd/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Parameter Estimate Coverage Assessment</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sdwfrost/egpd/blob/HEAD/vignettes/parameter-coverage.Rmd" class="external-link"><code>vignettes/parameter-coverage.Rmd</code></a></small>
      <div class="d-none name"><code>parameter-coverage.Rmd</code></div>
    </div>

    
    
<p>The predictive coverage vignette assesses whether prediction
intervals contain observed values. This complementary vignette asks a
different question: do the <strong>Wald confidence intervals</strong>
for the estimated parameters (sigma, xi, kappa) contain the true
parameter values at the nominal rate?</p>
<p>We assess this via Monte Carlo simulation across a grid of true
parameter values, using DEGPD model type 1 (the most numerically stable
variant).</p>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sdwfrost/egpd" class="external-link">egpd</a></span><span class="op">)</span></span></code></pre></div>
<p>We define a helper function that, for a given set of true parameters,
simulates <code>n_rep</code> datasets, fits each with
<code><a href="../reference/egpd.html">egpd()</a></code>, uses <code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code> to obtain Wald 95% CIs
on the response scale, and checks whether the true values are
covered.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_param_coverage</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sigma</span>, <span class="va">xi</span>, <span class="va">kappa</span>, <span class="va">n</span> <span class="op">=</span> <span class="fl">500</span>, <span class="va">n_rep</span> <span class="op">=</span> <span class="fl">200</span>,</span>
<span>                               <span class="va">level</span> <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">true_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sigma</span>, <span class="va">xi</span>, <span class="va">kappa</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Matrices to store results: n_rep x 3</span></span>
<span>  <span class="va">covered</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">n_rep</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">n_rep</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">covered</span><span class="op">)</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sigma"</span>, <span class="st">"xi"</span>, <span class="st">"kappa"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sigma"</span>, <span class="st">"xi"</span>, <span class="st">"kappa"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_rep</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rdiscegpd.html">rdiscegpd</a></span><span class="op">(</span><span class="va">n</span>, sigma <span class="op">=</span> <span class="va">sigma</span>, xi <span class="op">=</span> <span class="va">xi</span>, kappa <span class="op">=</span> <span class="va">kappa</span>, type <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">fit</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu"><a href="../reference/egpd.html">egpd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lsigma <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, lxi <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>, lkappa <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>           data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="st">"degpd"</span>, degpd.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="cn">NULL</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span> <span class="kw">next</span></span>
<span></span>
<span>    <span class="va">ci</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit</span>, method <span class="op">=</span> <span class="st">"wald"</span>, level <span class="op">=</span> <span class="va">level</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="cn">NULL</span></span>
<span>    <span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">ci</span><span class="op">)</span><span class="op">)</span> <span class="kw">next</span></span>
<span></span>
<span>    <span class="co"># Response-scale point estimates (level = 0 collapses CI to MLE)</span></span>
<span>    <span class="va">estimates</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit</span>, method <span class="op">=</span> <span class="st">"wald"</span>, level <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">ci</span><span class="op">[</span><span class="va">k</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">covered</span><span class="op">[</span><span class="va">i</span>, <span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">true_vals</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">ci</span><span class="op">[</span><span class="va">k</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>                          <span class="op">(</span><span class="va">true_vals</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">ci</span><span class="op">[</span><span class="va">k</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Coverage = fraction of successful fits where CI covers truth</span></span>
<span>  <span class="va">ok</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">covered</span><span class="op">)</span></span>
<span>  <span class="va">cov_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">covered</span><span class="op">[</span><span class="va">ok</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Relative bias = (estimate - true) / true</span></span>
<span>  <span class="va">ok_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span></span>
<span>  <span class="va">rel_bias</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sweep.html" class="external-link">sweep</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">[</span><span class="va">ok_est</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">true_vals</span>, <span class="st">"-"</span><span class="op">)</span></span>
<span>  <span class="va">rel_bias</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sweep.html" class="external-link">sweep</a></span><span class="op">(</span><span class="va">rel_bias</span>, <span class="fl">2</span>, <span class="va">true_vals</span>, <span class="st">"/"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>coverage <span class="op">=</span> <span class="va">cov_rate</span>, n_ok <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ok</span><span class="op">)</span>, n_rep <span class="op">=</span> <span class="va">n_rep</span>,</span>
<span>       estimates <span class="op">=</span> <span class="va">estimates</span><span class="op">[</span><span class="va">ok_est</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>,</span>
<span>       rel_bias <span class="op">=</span> <span class="va">rel_bias</span>,</span>
<span>       true_vals <span class="op">=</span> <span class="va">true_vals</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="varying-sigma">Varying sigma<a class="anchor" aria-label="anchor" href="#varying-sigma"></a>
</h2>
<p>We fix xi = 0.2 and kappa = 2, and vary sigma across five values.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span></span>
<span><span class="va">sigma_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">xi_fix</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span><span class="va">kappa_fix</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span></span>
<span><span class="va">res_sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">sigma_vals</span>, <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">sim_param_coverage</span><span class="op">(</span>sigma <span class="op">=</span> <span class="va">s</span>, xi <span class="op">=</span> <span class="va">xi_fix</span>, kappa <span class="op">=</span> <span class="va">kappa_fix</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tab_sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">sigma_vals</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">r</span> <span class="op">&lt;-</span> <span class="va">res_sigma</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>sigma_true <span class="op">=</span> <span class="va">sigma_vals</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,</span>
<span>             cov_sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">coverage</span><span class="op">[</span><span class="st">"sigma"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>             cov_xi    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">coverage</span><span class="op">[</span><span class="st">"xi"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>             cov_kappa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">coverage</span><span class="op">[</span><span class="st">"kappa"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>             n_ok      <span class="op">=</span> <span class="va">r</span><span class="op">$</span><span class="va">n_ok</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tab_sigma</span></span>
<span><span class="co">#&gt;        sigma_true cov_sigma cov_xi cov_kappa n_ok</span></span>
<span><span class="co">#&gt; sigma           1     0.905  0.970     0.894  199</span></span>
<span><span class="co">#&gt; sigma1          2     0.950  0.970     0.945  199</span></span>
<span><span class="co">#&gt; sigma2          3     0.960  0.965     0.945  200</span></span>
<span><span class="co">#&gt; sigma3          5     0.965  0.965     0.945  200</span></span>
<span><span class="co">#&gt; sigma4         10     0.980  0.945     0.945  200</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se_cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">0.95</span> <span class="op">*</span> <span class="fl">0.05</span> <span class="op">/</span> <span class="fl">200</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sigma_vals</span>, <span class="va">tab_sigma</span><span class="op">$</span><span class="va">cov_sigma</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"steelblue"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.85</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">[</span><span class="va">true</span><span class="op">]</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"Coverage"</span>,</span>
<span>     main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Coverage vs "</span> <span class="op">*</span> <span class="va">sigma</span><span class="op">[</span><span class="va">true</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">sigma_vals</span>, <span class="va">tab_sigma</span><span class="op">$</span><span class="va">cov_xi</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">17</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"firebrick"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">sigma_vals</span>, <span class="va">tab_sigma</span><span class="op">$</span><span class="va">cov_kappa</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">15</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"forestgreen"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0.95</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rect.html" class="external-link">rect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">sigma_vals</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fl">0.95</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">se_cov</span>,</span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">sigma_vals</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>, <span class="fl">0.95</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">se_cov</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"grey70"</span>, alpha.f <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>, border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">xi</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">kappa</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="st">"firebrick"</span>, <span class="st">"forestgreen"</span><span class="op">)</span>,</span>
<span>       pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">15</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-coverage_files/figure-html/sigma-coverage-plot-1.png" class="r-plt" alt="" width="576"></p>
</div>
<div class="section level2">
<h2 id="varying-xi">Varying xi<a class="anchor" aria-label="anchor" href="#varying-xi"></a>
</h2>
<p>We fix sigma = 3 and kappa = 2, and vary xi.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">102</span><span class="op">)</span></span>
<span><span class="va">xi_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">1.0</span><span class="op">)</span></span>
<span><span class="va">sigma_fix</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span></span>
<span><span class="va">res_xi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">xi_vals</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">sim_param_coverage</span><span class="op">(</span>sigma <span class="op">=</span> <span class="va">sigma_fix</span>, xi <span class="op">=</span> <span class="va">x</span>, kappa <span class="op">=</span> <span class="va">kappa_fix</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tab_xi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">xi_vals</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">r</span> <span class="op">&lt;-</span> <span class="va">res_xi</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>xi_true   <span class="op">=</span> <span class="va">xi_vals</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,</span>
<span>             cov_sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">coverage</span><span class="op">[</span><span class="st">"sigma"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>             cov_xi    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">coverage</span><span class="op">[</span><span class="st">"xi"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>             cov_kappa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">coverage</span><span class="op">[</span><span class="st">"kappa"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>             n_ok      <span class="op">=</span> <span class="va">r</span><span class="op">$</span><span class="va">n_ok</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tab_xi</span></span>
<span><span class="co">#&gt;        xi_true cov_sigma cov_xi cov_kappa n_ok</span></span>
<span><span class="co">#&gt; sigma     0.05     0.905   0.91     0.940  200</span></span>
<span><span class="co">#&gt; sigma1    0.10     0.915   0.94     0.930  200</span></span>
<span><span class="co">#&gt; sigma2    0.20     0.945   0.95     0.950  200</span></span>
<span><span class="co">#&gt; sigma3    0.50     0.955   0.95     0.970  200</span></span>
<span><span class="co">#&gt; sigma4    1.00     0.965   0.95     0.975  199</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xi_vals</span>, <span class="va">tab_xi</span><span class="op">$</span><span class="va">cov_sigma</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"steelblue"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.85</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">xi</span><span class="op">[</span><span class="va">true</span><span class="op">]</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"Coverage"</span>,</span>
<span>     main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Coverage vs "</span> <span class="op">*</span> <span class="va">xi</span><span class="op">[</span><span class="va">true</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">xi_vals</span>, <span class="va">tab_xi</span><span class="op">$</span><span class="va">cov_xi</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">17</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"firebrick"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">xi_vals</span>, <span class="va">tab_xi</span><span class="op">$</span><span class="va">cov_kappa</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">15</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"forestgreen"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0.95</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rect.html" class="external-link">rect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">xi_vals</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.1</span>, <span class="fl">0.95</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">se_cov</span>,</span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">xi_vals</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span>, <span class="fl">0.95</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">se_cov</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"grey70"</span>, alpha.f <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>, border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">xi</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">kappa</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="st">"firebrick"</span>, <span class="st">"forestgreen"</span><span class="op">)</span>,</span>
<span>       pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">15</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-coverage_files/figure-html/xi-coverage-plot-1.png" class="r-plt" alt="" width="576"></p>
</div>
<div class="section level2">
<h2 id="varying-kappa">Varying kappa<a class="anchor" aria-label="anchor" href="#varying-kappa"></a>
</h2>
<p>We fix sigma = 3 and xi = 0.2, and vary kappa.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">103</span><span class="op">)</span></span>
<span><span class="va">kappa_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">xi_fix2</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span></span>
<span><span class="va">res_kappa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">kappa_vals</span>, <span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">sim_param_coverage</span><span class="op">(</span>sigma <span class="op">=</span> <span class="va">sigma_fix</span>, xi <span class="op">=</span> <span class="va">xi_fix2</span>, kappa <span class="op">=</span> <span class="va">k</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tab_kappa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">kappa_vals</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">r</span> <span class="op">&lt;-</span> <span class="va">res_kappa</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>kappa_true <span class="op">=</span> <span class="va">kappa_vals</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,</span>
<span>             cov_sigma  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">coverage</span><span class="op">[</span><span class="st">"sigma"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>             cov_xi     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">coverage</span><span class="op">[</span><span class="st">"xi"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>             cov_kappa  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">coverage</span><span class="op">[</span><span class="st">"kappa"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>             n_ok       <span class="op">=</span> <span class="va">r</span><span class="op">$</span><span class="va">n_ok</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">tab_kappa</span></span>
<span><span class="co">#&gt;        kappa_true cov_sigma cov_xi cov_kappa n_ok</span></span>
<span><span class="co">#&gt; sigma         0.5     0.905  0.950      0.93  200</span></span>
<span><span class="co">#&gt; sigma1        1.0     0.955  0.970      0.96  200</span></span>
<span><span class="co">#&gt; sigma2        2.0     0.945  0.955      0.94  200</span></span>
<span><span class="co">#&gt; sigma3        3.0     0.950  0.975      0.96  199</span></span>
<span><span class="co">#&gt; sigma4        5.0     0.960  0.970      0.96  200</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">kappa_vals</span>, <span class="va">tab_kappa</span><span class="op">$</span><span class="va">cov_sigma</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"steelblue"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.85</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">kappa</span><span class="op">[</span><span class="va">true</span><span class="op">]</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"Coverage"</span>,</span>
<span>     main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Coverage vs "</span> <span class="op">*</span> <span class="va">kappa</span><span class="op">[</span><span class="va">true</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">kappa_vals</span>, <span class="va">tab_kappa</span><span class="op">$</span><span class="va">cov_xi</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">17</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"firebrick"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">kappa_vals</span>, <span class="va">tab_kappa</span><span class="op">$</span><span class="va">cov_kappa</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">15</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"forestgreen"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0.95</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rect.html" class="external-link">rect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">kappa_vals</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.5</span>, <span class="fl">0.95</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">se_cov</span>,</span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">kappa_vals</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span>, <span class="fl">0.95</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">se_cov</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"grey70"</span>, alpha.f <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>, border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">xi</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">kappa</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="st">"firebrick"</span>, <span class="st">"forestgreen"</span><span class="op">)</span>,</span>
<span>       pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">15</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-coverage_files/figure-html/kappa-coverage-plot-1.png" class="r-plt" alt="" width="576"></p>
</div>
<div class="section level2">
<h2 id="bias-and-precision">Bias and precision<a class="anchor" aria-label="anchor" href="#bias-and-precision"></a>
</h2>
<p>Beyond coverage, it is useful to check whether the estimator is
approximately unbiased. The boxplots below show the relative bias
(estimate - true) / true for each parameter across all 15 scenarios.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Combine all relative bias matrices with scenario labels</span></span>
<span><span class="va">make_bias_df</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">res_list</span>, <span class="va">varied_name</span>, <span class="va">varied_vals</span>, <span class="va">fixed_label</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">varied_vals</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">rb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">res_list</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">rel_bias</span><span class="op">)</span></span>
<span>    <span class="va">rb</span><span class="op">$</span><span class="va">scenario</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">varied_name</span>, <span class="st">" = "</span>, <span class="va">varied_vals</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">rb</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="va">fixed_label</span></span>
<span>    <span class="va">rb</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">bias_sigma</span> <span class="op">&lt;-</span> <span class="fu">make_bias_df</span><span class="op">(</span><span class="va">res_sigma</span>, <span class="st">"sigma"</span>, <span class="va">sigma_vals</span>, <span class="st">"Vary sigma"</span><span class="op">)</span></span>
<span><span class="va">bias_xi</span>    <span class="op">&lt;-</span> <span class="fu">make_bias_df</span><span class="op">(</span><span class="va">res_xi</span>, <span class="st">"xi"</span>, <span class="va">xi_vals</span>, <span class="st">"Vary xi"</span><span class="op">)</span></span>
<span><span class="va">bias_kappa</span> <span class="op">&lt;-</span> <span class="fu">make_bias_df</span><span class="op">(</span><span class="va">res_kappa</span>, <span class="st">"kappa"</span>, <span class="va">kappa_vals</span>, <span class="st">"Vary kappa"</span><span class="op">)</span></span>
<span><span class="va">bias_all</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">bias_sigma</span>, <span class="va">bias_xi</span>, <span class="va">bias_kappa</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">sigma</span> <span class="op">~</span> <span class="va">scenario</span>, data <span class="op">=</span> <span class="va">bias_sigma</span>,</span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Relative bias: "</span> <span class="op">*</span> <span class="va">sigma</span><span class="op">)</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"(est - true) / true"</span>, las <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>        outline <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">xi</span> <span class="op">~</span> <span class="va">scenario</span>, data <span class="op">=</span> <span class="va">bias_sigma</span>,</span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Relative bias: "</span> <span class="op">*</span> <span class="va">xi</span><span class="op">)</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">""</span>, las <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"firebrick"</span>,</span>
<span>        outline <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">kappa</span> <span class="op">~</span> <span class="va">scenario</span>, data <span class="op">=</span> <span class="va">bias_sigma</span>,</span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Relative bias: "</span> <span class="op">*</span> <span class="va">kappa</span><span class="op">)</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">""</span>, las <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"forestgreen"</span>,</span>
<span>        outline <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-coverage_files/figure-html/bias-sigma-plot-1.png" class="r-plt" alt="" width="672"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">sigma</span> <span class="op">~</span> <span class="va">scenario</span>, data <span class="op">=</span> <span class="va">bias_xi</span>,</span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Relative bias: "</span> <span class="op">*</span> <span class="va">sigma</span><span class="op">)</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"(est - true) / true"</span>, las <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>        outline <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">xi</span> <span class="op">~</span> <span class="va">scenario</span>, data <span class="op">=</span> <span class="va">bias_xi</span>,</span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Relative bias: "</span> <span class="op">*</span> <span class="va">xi</span><span class="op">)</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">""</span>, las <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"firebrick"</span>,</span>
<span>        outline <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">kappa</span> <span class="op">~</span> <span class="va">scenario</span>, data <span class="op">=</span> <span class="va">bias_xi</span>,</span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Relative bias: "</span> <span class="op">*</span> <span class="va">kappa</span><span class="op">)</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">""</span>, las <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"forestgreen"</span>,</span>
<span>        outline <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-coverage_files/figure-html/bias-xi-plot-1.png" class="r-plt" alt="" width="672"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">sigma</span> <span class="op">~</span> <span class="va">scenario</span>, data <span class="op">=</span> <span class="va">bias_kappa</span>,</span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Relative bias: "</span> <span class="op">*</span> <span class="va">sigma</span><span class="op">)</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">"(est - true) / true"</span>, las <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"steelblue"</span>,</span>
<span>        outline <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">xi</span> <span class="op">~</span> <span class="va">scenario</span>, data <span class="op">=</span> <span class="va">bias_kappa</span>,</span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Relative bias: "</span> <span class="op">*</span> <span class="va">xi</span><span class="op">)</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">""</span>, las <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"firebrick"</span>,</span>
<span>        outline <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">kappa</span> <span class="op">~</span> <span class="va">scenario</span>, data <span class="op">=</span> <span class="va">bias_kappa</span>,</span>
<span>        main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Relative bias: "</span> <span class="op">*</span> <span class="va">kappa</span><span class="op">)</span>,</span>
<span>        ylab <span class="op">=</span> <span class="st">""</span>, las <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"forestgreen"</span>,</span>
<span>        outline <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-coverage_files/figure-html/bias-kappa-plot-1.png" class="r-plt" alt="" width="672"></p>
</div>
<div class="section level2">
<h2 id="wald-summary">Wald Summary<a class="anchor" aria-label="anchor" href="#wald-summary"></a>
</h2>
<p>Across 15 parameter combinations (5 values each for sigma, xi, and
kappa, varied one at a time), the Wald 95% confidence intervals from
<code><a href="../reference/egpd.html">egpd()</a></code> achieve empirical coverage close to the nominal 95%
level. Key findings:</p>
<ul>
<li>
<strong>Coverage is well-calibrated</strong>: across all scenarios,
coverage rates cluster around 95%, well within the Monte Carlo
simulation error of approximately 1.5 percentage points.</li>
<li>
<strong>Bias is small</strong>: the relative bias boxplots show that
parameter estimates are approximately centred around the true values.
Small-sample bias is visible for extreme parameter values (e.g.Â very
small xi or large kappa) but diminishes with sample size.</li>
<li>
<strong>Robustness</strong>: the Wald intervals based on the
observed information matrix (<code>Vp</code>) provide reliable
frequentist coverage for the DEGPD model type 1 across a range of
parameter configurations.</li>
</ul>
</div>
<div class="section level2">
<h2 id="profile-likelihood-confidence-intervals">Profile Likelihood Confidence Intervals<a class="anchor" aria-label="anchor" href="#profile-likelihood-confidence-intervals"></a>
</h2>
<p>The <code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code> method for egpd objects supports both Wald
and profile likelihood confidence intervals. Profile likelihood CIs
invert the likelihood ratio test and do not rely on the normal
approximation, so they can provide better coverage when the
log-likelihood surface is asymmetric or the sample size is moderate.</p>
<p>Here is a single-fit example comparing Wald and profile CIs:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">200</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rdiscegpd.html">rdiscegpd</a></span><span class="op">(</span><span class="fl">500</span>, sigma <span class="op">=</span> <span class="fl">3</span>, xi <span class="op">=</span> <span class="fl">0.2</span>, kappa <span class="op">=</span> <span class="fl">2</span>, type <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/egpd.html">egpd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lsigma <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, lxi <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>, lkappa <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>            data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="st">"degpd"</span>, degpd.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ci_wald</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit</span>, method <span class="op">=</span> <span class="st">"wald"</span><span class="op">)</span></span>
<span><span class="va">ci_profile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit</span>, method <span class="op">=</span> <span class="st">"profile"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Wald CIs (response scale):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Wald CIs (response scale):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ci_wald</span><span class="op">)</span></span>
<span><span class="co">#&gt;           lower     upper</span></span>
<span><span class="co">#&gt; scale 1.9367855 3.2081659</span></span>
<span><span class="co">#&gt; shape 0.1469172 0.3449858</span></span>
<span><span class="co">#&gt; kappa 1.9318300 3.1180295</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nProfile CIs (response scale):\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Profile CIs (response scale):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ci_profile</span><span class="op">)</span></span>
<span><span class="co">#&gt;           lower     upper</span></span>
<span><span class="co">#&gt; scale 1.8889002 3.1513029</span></span>
<span><span class="co">#&gt; shape 0.1374116 0.3294722</span></span>
<span><span class="co">#&gt; kappa 1.9591248 3.1810526</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="wald-vs-profile-coverage">Wald vs Profile Coverage<a class="anchor" aria-label="anchor" href="#wald-vs-profile-coverage"></a>
</h2>
<p>We now compare coverage of Wald and profile CIs across a reduced grid
of parameter values (3 values per parameter, 100 replications per
scenario) since profile likelihood optimisation is more expensive.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_param_coverage_both</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sigma</span>, <span class="va">xi</span>, <span class="va">kappa</span>, <span class="va">n</span> <span class="op">=</span> <span class="fl">500</span>, <span class="va">n_rep</span> <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                                    <span class="va">level</span> <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">true_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sigma</span>, <span class="va">xi</span>, <span class="va">kappa</span><span class="op">)</span></span>
<span>  <span class="va">nms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sigma"</span>, <span class="st">"xi"</span>, <span class="st">"kappa"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">wald_covered</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">n_rep</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="va">profile_covered</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow <span class="op">=</span> <span class="va">n_rep</span>, ncol <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">wald_covered</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">profile_covered</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">nms</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_rep</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rdiscegpd.html">rdiscegpd</a></span><span class="op">(</span><span class="va">n</span>, sigma <span class="op">=</span> <span class="va">sigma</span>, xi <span class="op">=</span> <span class="va">xi</span>, kappa <span class="op">=</span> <span class="va">kappa</span>, type <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">fit</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="fu"><a href="../reference/egpd.html">egpd</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lsigma <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, lxi <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>, lkappa <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>           data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="st">"degpd"</span>, degpd.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="cn">NULL</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span><span class="op">)</span> <span class="kw">next</span></span>
<span></span>
<span>    <span class="va">ci_w</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit</span>, method <span class="op">=</span> <span class="st">"wald"</span>, level <span class="op">=</span> <span class="va">level</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                     error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span>    <span class="va">ci_p</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit</span>, method <span class="op">=</span> <span class="st">"profile"</span>, level <span class="op">=</span> <span class="va">level</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                     error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">ci_w</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">ci_w</span><span class="op">[</span><span class="va">k</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>          <span class="va">wald_covered</span><span class="op">[</span><span class="va">i</span>, <span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">true_vals</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">ci_w</span><span class="op">[</span><span class="va">k</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>                                 <span class="op">(</span><span class="va">true_vals</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">ci_w</span><span class="op">[</span><span class="va">k</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">ci_p</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">ci_p</span><span class="op">[</span><span class="va">k</span>, <span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>          <span class="va">profile_covered</span><span class="op">[</span><span class="va">i</span>, <span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">true_vals</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&gt;=</span> <span class="va">ci_p</span><span class="op">[</span><span class="va">k</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>                                    <span class="op">(</span><span class="va">true_vals</span><span class="op">[</span><span class="va">k</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">ci_p</span><span class="op">[</span><span class="va">k</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">ok_w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">wald_covered</span><span class="op">)</span></span>
<span>  <span class="va">ok_p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">profile_covered</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    wald_coverage    <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ok_w</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">wald_covered</span><span class="op">[</span><span class="va">ok_w</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    profile_coverage <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ok_p</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">profile_covered</span><span class="op">[</span><span class="va">ok_p</span>, , drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>    n_ok_wald    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ok_w</span><span class="op">)</span>,</span>
<span>    n_ok_profile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">ok_p</span><span class="op">)</span>,</span>
<span>    true_vals    <span class="op">=</span> <span class="va">true_vals</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level3">
<h3 id="varying-sigma-wald-vs-profile">Varying sigma (Wald vs Profile)<a class="anchor" aria-label="anchor" href="#varying-sigma-wald-vs-profile"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">301</span><span class="op">)</span></span>
<span><span class="va">sigma_vals_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">xi_fix_b</span> <span class="op">&lt;-</span> <span class="fl">0.2</span></span>
<span><span class="va">kappa_fix_b</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span></span>
<span><span class="va">res_both_sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">sigma_vals_b</span>, <span class="kw">function</span><span class="op">(</span><span class="va">s</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">sim_param_coverage_both</span><span class="op">(</span>sigma <span class="op">=</span> <span class="va">s</span>, xi <span class="op">=</span> <span class="va">xi_fix_b</span>, kappa <span class="op">=</span> <span class="va">kappa_fix_b</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="varying-xi-wald-vs-profile">Varying xi (Wald vs Profile)<a class="anchor" aria-label="anchor" href="#varying-xi-wald-vs-profile"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">302</span><span class="op">)</span></span>
<span><span class="va">xi_vals_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_both_xi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">xi_vals_b</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">sim_param_coverage_both</span><span class="op">(</span>sigma <span class="op">=</span> <span class="fl">3</span>, xi <span class="op">=</span> <span class="va">x</span>, kappa <span class="op">=</span> <span class="va">kappa_fix_b</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="varying-kappa-wald-vs-profile">Varying kappa (Wald vs Profile)<a class="anchor" aria-label="anchor" href="#varying-kappa-wald-vs-profile"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">303</span><span class="op">)</span></span>
<span><span class="va">kappa_vals_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">res_both_kappa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">kappa_vals_b</span>, <span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">sim_param_coverage_both</span><span class="op">(</span>sigma <span class="op">=</span> <span class="fl">3</span>, xi <span class="op">=</span> <span class="va">xi_fix_b</span>, kappa <span class="op">=</span> <span class="va">k</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="coverage-comparison-tables">Coverage comparison tables<a class="anchor" aria-label="anchor" href="#coverage-comparison-tables"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">make_both_table</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">res_list</span>, <span class="va">varied_name</span>, <span class="va">varied_vals</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">varied_vals</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">j</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">r</span> <span class="op">&lt;-</span> <span class="va">res_list</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>      param_value <span class="op">=</span> <span class="va">varied_vals</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>,</span>
<span>      wald_sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">wald_coverage</span><span class="op">[</span><span class="st">"sigma"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>      prof_sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">profile_coverage</span><span class="op">[</span><span class="st">"sigma"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>      wald_xi    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">wald_coverage</span><span class="op">[</span><span class="st">"xi"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>      prof_xi    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">profile_coverage</span><span class="op">[</span><span class="st">"xi"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>      wald_kappa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">wald_coverage</span><span class="op">[</span><span class="st">"kappa"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>      prof_kappa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">r</span><span class="op">$</span><span class="va">profile_coverage</span><span class="op">[</span><span class="st">"kappa"</span><span class="op">]</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Varying sigma:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Varying sigma:</span></span>
<span><span class="fu">make_both_table</span><span class="op">(</span><span class="va">res_both_sigma</span>, <span class="st">"sigma"</span>, <span class="va">sigma_vals_b</span><span class="op">)</span></span>
<span><span class="co">#&gt;        param_value wald_sigma prof_sigma wald_xi prof_xi wald_kappa prof_kappa</span></span>
<span><span class="co">#&gt; sigma            1       0.95       0.94    0.98    0.95       0.96       0.95</span></span>
<span><span class="co">#&gt; sigma1           3       0.97       0.96    0.98    0.96       0.97       0.96</span></span>
<span><span class="co">#&gt; sigma2          10       0.93       0.92    0.95    0.95       0.94       0.94</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nVarying xi:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Varying xi:</span></span>
<span><span class="fu">make_both_table</span><span class="op">(</span><span class="va">res_both_xi</span>, <span class="st">"xi"</span>, <span class="va">xi_vals_b</span><span class="op">)</span></span>
<span><span class="co">#&gt;        param_value wald_sigma prof_sigma wald_xi prof_xi wald_kappa prof_kappa</span></span>
<span><span class="co">#&gt; sigma          0.1      0.900      0.910    0.95    0.92      0.970      0.970</span></span>
<span><span class="co">#&gt; sigma1         0.2      0.960      0.949    0.99    0.97      0.949      0.949</span></span>
<span><span class="co">#&gt; sigma2         0.5      0.929      0.940    0.96    0.95      0.970      0.950</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nVarying kappa:\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Varying kappa:</span></span>
<span><span class="fu">make_both_table</span><span class="op">(</span><span class="va">res_both_kappa</span>, <span class="st">"kappa"</span>, <span class="va">kappa_vals_b</span><span class="op">)</span></span>
<span><span class="co">#&gt;        param_value wald_sigma prof_sigma wald_xi prof_xi wald_kappa prof_kappa</span></span>
<span><span class="co">#&gt; sigma          0.5       0.96       0.97    0.99    0.98       0.96       0.97</span></span>
<span><span class="co">#&gt; sigma1         2.0       0.97       0.97    0.98    0.95       0.99       1.00</span></span>
<span><span class="co">#&gt; sigma2         5.0       0.97       0.96    0.99    0.98       0.94       0.97</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="coverage-comparison-plot">Coverage comparison plot<a class="anchor" aria-label="anchor" href="#coverage-comparison-plot"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">se_cov_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">0.95</span> <span class="op">*</span> <span class="fl">0.05</span> <span class="op">/</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># --- Vary sigma ---</span></span>
<span><span class="va">tab_bs</span> <span class="op">&lt;-</span> <span class="fu">make_both_table</span><span class="op">(</span><span class="va">res_both_sigma</span>, <span class="st">"sigma"</span>, <span class="va">sigma_vals_b</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sigma_vals_b</span>, <span class="va">tab_bs</span><span class="op">$</span><span class="va">wald_sigma</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"steelblue"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.80</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">[</span><span class="va">true</span><span class="op">]</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"Coverage"</span>,</span>
<span>     main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Vary "</span> <span class="op">*</span> <span class="va">sigma</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">sigma_vals_b</span>, <span class="va">tab_bs</span><span class="op">$</span><span class="va">prof_sigma</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"steelblue"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">sigma_vals_b</span>, <span class="va">tab_bs</span><span class="op">$</span><span class="va">wald_xi</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">17</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"firebrick"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">sigma_vals_b</span>, <span class="va">tab_bs</span><span class="op">$</span><span class="va">prof_xi</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">17</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"firebrick"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">sigma_vals_b</span>, <span class="va">tab_bs</span><span class="op">$</span><span class="va">wald_kappa</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">15</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"forestgreen"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">sigma_vals_b</span>, <span class="va">tab_bs</span><span class="op">$</span><span class="va">prof_kappa</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">15</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"forestgreen"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0.95</span>, lty <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rect.html" class="external-link">rect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">sigma_vals_b</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fl">0.95</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">se_cov_b</span>,</span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">sigma_vals_b</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>, <span class="fl">0.95</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">se_cov_b</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"grey70"</span>, alpha.f <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>, border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># --- Vary xi ---</span></span>
<span><span class="va">tab_bx</span> <span class="op">&lt;-</span> <span class="fu">make_both_table</span><span class="op">(</span><span class="va">res_both_xi</span>, <span class="st">"xi"</span>, <span class="va">xi_vals_b</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xi_vals_b</span>, <span class="va">tab_bx</span><span class="op">$</span><span class="va">wald_sigma</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"steelblue"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.80</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">xi</span><span class="op">[</span><span class="va">true</span><span class="op">]</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"Coverage"</span>,</span>
<span>     main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Vary "</span> <span class="op">*</span> <span class="va">xi</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">xi_vals_b</span>, <span class="va">tab_bx</span><span class="op">$</span><span class="va">prof_sigma</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"steelblue"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">xi_vals_b</span>, <span class="va">tab_bx</span><span class="op">$</span><span class="va">wald_xi</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">17</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"firebrick"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">xi_vals_b</span>, <span class="va">tab_bx</span><span class="op">$</span><span class="va">prof_xi</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">17</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"firebrick"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">xi_vals_b</span>, <span class="va">tab_bx</span><span class="op">$</span><span class="va">wald_kappa</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">15</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"forestgreen"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">xi_vals_b</span>, <span class="va">tab_bx</span><span class="op">$</span><span class="va">prof_kappa</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">15</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"forestgreen"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0.95</span>, lty <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rect.html" class="external-link">rect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">xi_vals_b</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.05</span>, <span class="fl">0.95</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">se_cov_b</span>,</span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">xi_vals_b</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.05</span>, <span class="fl">0.95</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">se_cov_b</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"grey70"</span>, alpha.f <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>, border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># --- Vary kappa ---</span></span>
<span><span class="va">tab_bk</span> <span class="op">&lt;-</span> <span class="fu">make_both_table</span><span class="op">(</span><span class="va">res_both_kappa</span>, <span class="st">"kappa"</span>, <span class="va">kappa_vals_b</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">kappa_vals_b</span>, <span class="va">tab_bk</span><span class="op">$</span><span class="va">wald_sigma</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"steelblue"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.80</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>     xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">kappa</span><span class="op">[</span><span class="va">true</span><span class="op">]</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"Coverage"</span>,</span>
<span>     main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="st">"Vary "</span> <span class="op">*</span> <span class="va">kappa</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">kappa_vals_b</span>, <span class="va">tab_bk</span><span class="op">$</span><span class="va">prof_sigma</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">16</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"steelblue"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">kappa_vals_b</span>, <span class="va">tab_bk</span><span class="op">$</span><span class="va">wald_xi</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">17</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"firebrick"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">kappa_vals_b</span>, <span class="va">tab_bk</span><span class="op">$</span><span class="va">prof_xi</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">17</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"firebrick"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">kappa_vals_b</span>, <span class="va">tab_bk</span><span class="op">$</span><span class="va">wald_kappa</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">15</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"forestgreen"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">kappa_vals_b</span>, <span class="va">tab_bk</span><span class="op">$</span><span class="va">prof_kappa</span>, type <span class="op">=</span> <span class="st">"b"</span>, pch <span class="op">=</span> <span class="fl">15</span>,</span>
<span>      col <span class="op">=</span> <span class="st">"forestgreen"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0.95</span>, lty <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="st">"grey40"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rect.html" class="external-link">rect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">kappa_vals_b</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0.5</span>, <span class="fl">0.95</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">se_cov_b</span>,</span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">kappa_vals_b</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span>, <span class="fl">0.95</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">se_cov_b</span>,</span>
<span>     col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"grey70"</span>, alpha.f <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>, border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomright"</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">sigma</span> <span class="op">*</span> <span class="st">" Wald"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">sigma</span> <span class="op">*</span> <span class="st">" Profile"</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">xi</span> <span class="op">*</span> <span class="st">" Wald"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">xi</span> <span class="op">*</span> <span class="st">" Profile"</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">kappa</span> <span class="op">*</span> <span class="st">" Wald"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">kappa</span> <span class="op">*</span> <span class="st">" Profile"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"steelblue"</span>, <span class="st">"firebrick"</span>, <span class="st">"forestgreen"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>       pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">15</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>       lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="parameter-coverage_files/figure-html/both-coverage-plot-1.png" class="r-plt" alt="" width="864"></p>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>Across all parameter combinations, both Wald and profile likelihood
95% confidence intervals from <code><a href="../reference/egpd.html">egpd()</a></code> achieve empirical
coverage close to the nominal 95% level. Key findings:</p>
<ul>
<li>
<strong>Wald CIs are well-calibrated</strong>: across 15 scenarios
(5 values each for sigma, xi, and kappa), Wald coverage rates cluster
around 95%, well within Monte Carlo simulation error.</li>
<li>
<strong>Profile CIs offer comparable or improved coverage</strong>:
the profile likelihood intervals, which do not rely on the normal
approximation, tend to match or slightly improve on Wald coverage,
particularly for parameters whose log-likelihood surface is asymmetric
(e.g.Â small xi or extreme kappa).</li>
<li>
<strong>Bias is small</strong>: relative bias boxplots confirm that
parameter estimates are approximately centred around the true
values.</li>
<li>
<strong>Practical recommendation</strong>: for intercept-only
models, profile likelihood CIs via
<code>confint(fit, method = "profile")</code> provide a useful
complement to the default Wald intervals, especially for small to
moderate sample sizes. For models with smooth terms or covariates, the
Wald intervals remain the primary option.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Touqeer Ahmad, Simon Frost.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
