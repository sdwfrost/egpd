<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Fitting Discrete Distributions with fitegpd • egpd</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting Discrete Distributions with fitegpd">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">egpd</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/insurance-complaints.html">Discrete EGPD Models for Insurance Complaint Counts</a></li>
    <li><a class="dropdown-item" href="../articles/doctor-visits.html">Zero-Inflated Discrete EGPD Models for Doctor Visit Counts</a></li>
    <li><a class="dropdown-item" href="../articles/gaming-offenses.html">Threshold Exceedance Modeling with DEGPD</a></li>
    <li><a class="dropdown-item" href="../articles/simulation.html">Simulation Examples</a></li>
    <li><a class="dropdown-item" href="../articles/temperature-extremes.html">Continuous EGPD Models for Temperature Extremes</a></li>
    <li><a class="dropdown-item" href="../articles/fitegpd-continuous.html">Fitting Continuous Distributions with fitegpd</a></li>
    <li><a class="dropdown-item" href="../articles/fitegpd-discrete.html">Fitting Discrete Distributions with fitegpd</a></li>
    <li><a class="dropdown-item" href="../articles/bamlss-comparison.html">Comparing egpd and bamlss Fits</a></li>
    <li><a class="dropdown-item" href="../articles/gamlss-comparison.html">Comparing egpd and gamlss Fits</a></li>
    <li><a class="dropdown-item" href="../articles/predictive-coverage.html">Predictive Coverage Assessment</a></li>
    <li><a class="dropdown-item" href="../articles/parameter-coverage.html">Parameter Estimate Coverage Assessment</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sdwfrost/egpd/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fitting Discrete Distributions with fitegpd</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sdwfrost/egpd/blob/HEAD/vignettes/fitegpd-discrete.Rmd" class="external-link"><code>vignettes/fitegpd-discrete.Rmd</code></a></small>
      <div class="d-none name"><code>fitegpd-discrete.Rmd</code></div>
    </div>

    
    
<p>The <code><a href="../reference/fitegpd.html">fitegpd()</a></code> function supports two discrete
distribution families for fitting non-negative integer (count) data:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Discrete EGPD</strong> (<code>family = "degpd"</code>) — for
counts without excess zeros</li>
<li>
<strong>Zero-Inflated Discrete EGPD</strong>
(<code>family = "zidegpd"</code>) — for counts with more zeros than the
base model can accommodate</li>
</ol>
<p>Both discretize the continuous EGPD by placing the probability mass
of each integer
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
at
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false" form="prefix">(</mo><mi>X</mi><mo>=</mo><mi>k</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><msub><mi>F</mi><mrow><mi mathvariant="normal">E</mi><mi mathvariant="normal">G</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">D</mi></mrow></msub><mo stretchy="false" form="prefix">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo>−</mo><msub><mi>F</mi><mrow><mi mathvariant="normal">E</mi><mi mathvariant="normal">G</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">D</mi></mrow></msub><mo stretchy="false" form="prefix">(</mo><mi>k</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">P(X = k) = F_{\mathrm{EGPD}}(k+1) - F_{\mathrm{EGPD}}(k)</annotation></semantics></math>,
inheriting the flexible body and Pareto tail of the continuous model.
This makes them natural alternatives to the Poisson, negative binomial,
or Conway–Maxwell–Poisson for heavy-tailed or over-dispersed count
data.</p>
<div class="section level2">
<h2 id="discrete-egpd">1. Discrete EGPD<a class="anchor" aria-label="anchor" href="#discrete-egpd"></a>
</h2>
<div class="section level3">
<h3 id="the-model">The model<a class="anchor" aria-label="anchor" href="#the-model"></a>
</h3>
<p>The discrete EGPD (DEGPD) has PMF</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false" form="prefix">(</mo><mi>X</mi><mo>=</mo><mi>k</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mi>G</mi><mspace width="-0.167em"></mspace><mo minsize="120%" maxsize="120%" stretchy="true" form="prefix">(</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo><mo minsize="120%" maxsize="120%" stretchy="true" form="postfix">)</mo><mo>−</mo><mi>G</mi><mspace width="-0.167em"></mspace><mo minsize="120%" maxsize="120%" stretchy="true" form="prefix">(</mo><mi>H</mi><mo stretchy="false" form="prefix">(</mo><mi>k</mi><mo stretchy="false" form="postfix">)</mo><mo minsize="120%" maxsize="120%" stretchy="true" form="postfix">)</mo><mo>,</mo><mspace width="2.0em"></mspace><mi>k</mi><mo>=</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>…</mi></mrow><annotation encoding="application/x-tex">P(X = k) = G\!\bigl(H(k+1)\bigr) - G\!\bigl(H(k)\bigr), \qquad k = 0, 1, 2, \ldots</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>H</mi><annotation encoding="application/x-tex">H</annotation></semantics></math>
is the standard GPD CDF and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>
is the EGPD transformation function. As with the continuous EGPD, the
<code>type</code> argument selects the parametric form of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>G</mi><annotation encoding="application/x-tex">G</annotation></semantics></math>.</p>
</div>
<div class="section level3">
<h3 id="simulating-and-fitting">Simulating and fitting<a class="anchor" aria-label="anchor" href="#simulating-and-fitting"></a>
</h3>
<p>We generate data from a DEGPD Type 1 model and fit it back.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sdwfrost/egpd" class="external-link">egpd</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sigma_true</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">xi_true</span>    <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="va">kappa_true</span> <span class="op">&lt;-</span> <span class="fl">1.5</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rdiscegpd.html">rdiscegpd</a></span><span class="op">(</span><span class="fl">1000</span>, sigma <span class="op">=</span> <span class="va">sigma_true</span>, xi <span class="op">=</span> <span class="va">xi_true</span>,</span>
<span>               kappa <span class="op">=</span> <span class="va">kappa_true</span>, type <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Range:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Range: 0 51</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Mean:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"  Var:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Mean: 3.89   Var: 19</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Proportion zeros:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Proportion zeros: 0.145</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Simulated DEGPD data"</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"Proportion"</span>, col <span class="op">=</span> <span class="st">"lightblue"</span>, border <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span></code></pre></div>
<p><img src="fitegpd-discrete_files/figure-html/degpd-hist-1.png" class="r-plt" alt="" width="576"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_degpd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitegpd.html">fitegpd</a></span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="st">"degpd"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_degpd</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fitting of the distribution 'degpd' (type 1)</span></span>
<span><span class="co">#&gt; Method: mle</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated parameters:</span></span>
<span><span class="co">#&gt;       Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; sigma  2.79011    0.27440  10.168  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; xi     0.14362    0.04309   3.333 0.000859 ***</span></span>
<span><span class="co">#&gt; kappa  1.59145    0.13492  11.796  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Convergence:  successful </span></span>
<span><span class="co">#&gt; Loglikelihood:  -2457.38   AIC:  4920.77   BIC:  4935.49 </span></span>
<span><span class="co">#&gt; Number of observations:  1000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="parameter-recovery">Parameter recovery<a class="anchor" aria-label="anchor" href="#parameter-recovery"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">truth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>sigma <span class="op">=</span> <span class="va">sigma_true</span>, xi <span class="op">=</span> <span class="va">xi_true</span>, kappa <span class="op">=</span> <span class="va">kappa_true</span><span class="op">)</span></span>
<span><span class="va">est</span> <span class="op">&lt;-</span> <span class="va">fit_degpd</span><span class="op">$</span><span class="va">estimate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>true <span class="op">=</span> <span class="va">truth</span>, estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">est</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>      SE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_degpd</span><span class="op">$</span><span class="va">sd</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       true estimate     SE</span></span>
<span><span class="co">#&gt; sigma  3.0   2.7901 0.2744</span></span>
<span><span class="co">#&gt; xi     0.1   0.1436 0.0431</span></span>
<span><span class="co">#&gt; kappa  1.5   1.5915 0.1349</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="diagnostics">Diagnostics<a class="anchor" aria-label="anchor" href="#diagnostics"></a>
</h3>
<p>The diagnostic plot for discrete families shows the empirical PMF
with fitted probabilities (panel 1), a step-function CDF comparison
(panel 2), a normal Q-Q plot of randomized quantile residuals (panel 3),
and a P-P plot using the randomized probability integral transform
(panel 4). The randomized PIT (Dunn &amp; Smyth, 1996) spreads tied
discrete values into continuous uniform variates, producing clean
diagonal plots instead of the banded patterns that arise from
integer-valued quantiles.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_degpd</span><span class="op">)</span></span></code></pre></div>
<p><img src="fitegpd-discrete_files/figure-html/degpd-plot-1.png" class="r-plt" alt="" width="576"></p>
</div>
<div class="section level3">
<h3 id="comparing-types-by-aic">Comparing types by AIC<a class="anchor" aria-label="anchor" href="#comparing-types-by-aic"></a>
</h3>
<p>Different G-transformation types suit different data shapes. We can
use AIC to select among them:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aic_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  AIC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="fu"><a href="../reference/fitegpd.html">fitegpd</a></span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="st">"degpd"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="fu"><a href="../reference/fitegpd.html">fitegpd</a></span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="fl">4</span>, family <span class="op">=</span> <span class="st">"degpd"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="fu"><a href="../reference/fitegpd.html">fitegpd</a></span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="fl">5</span>, family <span class="op">=</span> <span class="st">"degpd"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">aic_table</span></span>
<span><span class="co">#&gt;   type      AIC</span></span>
<span><span class="co">#&gt; 1    1 4920.769</span></span>
<span><span class="co">#&gt; 2    4 4921.979</span></span>
<span><span class="co">#&gt; 3    5 4922.722</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="confidence-intervals">Confidence intervals<a class="anchor" aria-label="anchor" href="#confidence-intervals"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit_degpd</span><span class="op">)</span></span>
<span><span class="co">#&gt;            2.5 %    97.5 %</span></span>
<span><span class="co">#&gt; sigma 2.25229832 3.3279173</span></span>
<span><span class="co">#&gt; xi    0.05916484 0.2280755</span></span>
<span><span class="co">#&gt; kappa 1.32702000 1.8558842</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fixing-parameters">Fixing parameters<a class="anchor" aria-label="anchor" href="#fixing-parameters"></a>
</h3>
<p>As with continuous fits, individual parameters can be fixed at known
values:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_fix</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitegpd.html">fitegpd</a></span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="st">"degpd"</span>,</span>
<span>                    fix.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>xi <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_fix</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fitting of the distribution 'degpd' (type 1)</span></span>
<span><span class="co">#&gt; Method: mle</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated parameters:</span></span>
<span><span class="co">#&gt;       Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; sigma  3.03816    0.14717   20.64   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; kappa  1.49640    0.08492   17.62   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Fixed parameters:</span></span>
<span><span class="co">#&gt;    Value</span></span>
<span><span class="co">#&gt; xi   0.1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Convergence:  successful </span></span>
<span><span class="co">#&gt; Loglikelihood:  -2457.94   AIC:  4919.87   BIC:  4929.69 </span></span>
<span><span class="co">#&gt; Number of observations:  1000</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="zero-inflated-discrete-egpd">2. Zero-Inflated Discrete EGPD<a class="anchor" aria-label="anchor" href="#zero-inflated-discrete-egpd"></a>
</h2>
<div class="section level3">
<h3 id="the-model-1">The model<a class="anchor" aria-label="anchor" href="#the-model-1"></a>
</h3>
<p>Many count datasets have more zeros than any standard count model can
explain — e.g. the number of insurance claims (many policyholders file
none), species counts (many sites have zero individuals), or disease
counts (many days with no cases). The zero-inflated discrete EGPD
(ZIDEGPD) handles this by mixing a point mass at zero with the
DEGPD:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false" form="prefix">(</mo><mi>X</mi><mo>=</mo><mi>k</mi><mo stretchy="false" form="postfix">)</mo><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mi>π</mi><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>π</mi><mo stretchy="false" form="postfix">)</mo><mspace width="0.167em"></mspace><msub><mi>P</mi><mrow><mi mathvariant="normal">D</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">G</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">D</mi></mrow></msub><mo stretchy="false" form="prefix">(</mo><mi>X</mi><mo>=</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>k</mi><mo>=</mo><mn>0</mn></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>π</mi><mo stretchy="false" form="postfix">)</mo><mspace width="0.167em"></mspace><msub><mi>P</mi><mrow><mi mathvariant="normal">D</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">G</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">D</mi></mrow></msub><mo stretchy="false" form="prefix">(</mo><mi>X</mi><mo>=</mo><mi>k</mi><mo stretchy="false" form="postfix">)</mo></mtd><mtd columnalign="left" style="text-align: left"><mi>k</mi><mo>≥</mo><mn>1</mn></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">P(X = k) = \begin{cases}
\pi + (1-\pi)\,P_{\mathrm{DEGPD}}(X=0) &amp; k = 0 \\
(1-\pi)\,P_{\mathrm{DEGPD}}(X=k) &amp; k \ge 1
\end{cases}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo>∈</mo><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\pi \in (0,1)</annotation></semantics></math>
is the zero-inflation probability. The overall zero probability is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo>+</mo><mo stretchy="false" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>π</mi><mo stretchy="false" form="postfix">)</mo><mspace width="0.167em"></mspace><msub><mi>P</mi><mrow><mi mathvariant="normal">D</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">G</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">D</mi></mrow></msub><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">\pi + (1-\pi)\,P_{\mathrm{DEGPD}}(0)</annotation></semantics></math>,
which is always larger than
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi mathvariant="normal">D</mi><mi mathvariant="normal">E</mi><mi mathvariant="normal">G</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">D</mi></mrow></msub><mo stretchy="false" form="prefix">(</mo><mn>0</mn><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">P_{\mathrm{DEGPD}}(0)</annotation></semantics></math>
alone.</p>
</div>
<div class="section level3">
<h3 id="simulating-and-fitting-1">Simulating and fitting<a class="anchor" aria-label="anchor" href="#simulating-and-fitting-1"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sigma_true</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="va">xi_true</span>    <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="va">kappa_true</span> <span class="op">&lt;-</span> <span class="fl">1.5</span></span>
<span><span class="va">pi_true</span>    <span class="op">&lt;-</span> <span class="fl">0.3</span></span>
<span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rzidiscegpd.html">rzidiscegpd</a></span><span class="op">(</span><span class="fl">1000</span>, pi <span class="op">=</span> <span class="va">pi_true</span>, sigma <span class="op">=</span> <span class="va">sigma_true</span>,</span>
<span>                  xi <span class="op">=</span> <span class="va">xi_true</span>, kappa <span class="op">=</span> <span class="va">kappa_true</span>, type <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Range:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Range: 0 27</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Mean:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"  Var:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Mean: 1.72   Var: 7.42</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Proportion zeros:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">y</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Proportion zeros: 0.477</span></span></code></pre></div>
<p>The zero proportion should be notably higher than for the
non-inflated model because of the extra
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo>=</mo><mn>0.3</mn></mrow><annotation encoding="application/x-tex">\pi = 0.3</annotation></semantics></math>
point mass.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Simulated ZIDEGPD data"</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"y"</span>, ylab <span class="op">=</span> <span class="st">"Proportion"</span>, col <span class="op">=</span> <span class="st">"lightblue"</span>, border <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span></code></pre></div>
<p><img src="fitegpd-discrete_files/figure-html/zidegpd-hist-1.png" class="r-plt" alt="" width="576"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_zi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitegpd.html">fitegpd</a></span><span class="op">(</span><span class="va">y</span>, type <span class="op">=</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="st">"zidegpd"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_zi</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fitting of the distribution 'zidegpd' (type 1)</span></span>
<span><span class="co">#&gt; Method: mle</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated parameters:</span></span>
<span><span class="co">#&gt;       Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; sigma  1.75201    0.45741   3.830 0.000128 ***</span></span>
<span><span class="co">#&gt; xi     0.15800    0.07385   2.140 0.032389 *  </span></span>
<span><span class="co">#&gt; kappa  1.97969    0.84112   2.354 0.018590 *  </span></span>
<span><span class="co">#&gt; pi     0.36187    0.05998   6.034  1.6e-09 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Convergence:  successful </span></span>
<span><span class="co">#&gt; Loglikelihood:  -1745.38   AIC:  3498.76   BIC:  3518.39 </span></span>
<span><span class="co">#&gt; Number of observations:  1000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="parameter-recovery-1">Parameter recovery<a class="anchor" aria-label="anchor" href="#parameter-recovery-1"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">truth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>sigma <span class="op">=</span> <span class="va">sigma_true</span>, xi <span class="op">=</span> <span class="va">xi_true</span>,</span>
<span>           kappa <span class="op">=</span> <span class="va">kappa_true</span>, pi <span class="op">=</span> <span class="va">pi_true</span><span class="op">)</span></span>
<span><span class="va">est</span> <span class="op">&lt;-</span> <span class="va">fit_zi</span><span class="op">$</span><span class="va">estimate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>true <span class="op">=</span> <span class="va">truth</span>, estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">est</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>      SE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_zi</span><span class="op">$</span><span class="va">sd</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;       true estimate     SE</span></span>
<span><span class="co">#&gt; sigma  2.0   1.7520 0.4574</span></span>
<span><span class="co">#&gt; xi     0.1   0.1580 0.0738</span></span>
<span><span class="co">#&gt; kappa  1.5   1.9797 0.8411</span></span>
<span><span class="co">#&gt; pi     0.3   0.3619 0.0600</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="diagnostics-1">Diagnostics<a class="anchor" aria-label="anchor" href="#diagnostics-1"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_zi</span><span class="op">)</span></span></code></pre></div>
<p><img src="fitegpd-discrete_files/figure-html/zidegpd-plot-1.png" class="r-plt" alt="" width="576"></p>
</div>
<div class="section level3">
<h3 id="confidence-intervals-1">Confidence intervals<a class="anchor" aria-label="anchor" href="#confidence-intervals-1"></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit_zi</span><span class="op">)</span></span>
<span><span class="co">#&gt;            2.5 %    97.5 %</span></span>
<span><span class="co">#&gt; sigma 0.85549768 2.6485174</span></span>
<span><span class="co">#&gt; xi    0.01326359 0.3027374</span></span>
<span><span class="co">#&gt; kappa 0.33113076 3.6282584</span></span>
<span><span class="co">#&gt; pi    0.24431952 0.4794218</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="comparing-degpd-and-zidegpd">3. Comparing DEGPD and ZIDEGPD<a class="anchor" aria-label="anchor" href="#comparing-degpd-and-zidegpd"></a>
</h2>
<p>When faced with zero-heavy count data, a natural question is whether
the zero inflation is needed or whether the base DEGPD already accounts
for the zeros adequately. We can compare the two models by AIC.</p>
<div class="section level3">
<h3 id="fitting-both-models-to-zero-inflated-data">Fitting both models to zero-inflated data<a class="anchor" aria-label="anchor" href="#fitting-both-models-to-zero-inflated-data"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_no_zi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitegpd.html">fitegpd</a></span><span class="op">(</span><span class="va">y</span>, type <span class="op">=</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="st">"degpd"</span><span class="op">)</span></span>
<span><span class="va">fit_with_zi</span> <span class="op">&lt;-</span> <span class="va">fit_zi</span>  <span class="co"># already fitted above</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"DEGPD AIC:   "</span>, <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fit_no_zi</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; DEGPD AIC:    3503.567</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"ZIDEGPD AIC: "</span>, <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fit_with_zi</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ZIDEGPD AIC:  3498.756</span></span></code></pre></div>
<p>Since the data were generated with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mo>=</mo><mn>0.3</mn></mrow><annotation encoding="application/x-tex">\pi = 0.3</annotation></semantics></math>,
the zero-inflated model should have a substantially lower AIC.</p>
</div>
<div class="section level3">
<h3 id="fitting-both-models-to-non-inflated-data">Fitting both models to non-inflated data<a class="anchor" aria-label="anchor" href="#fitting-both-models-to-non-inflated-data"></a>
</h3>
<p>Conversely, when the data have no excess zeros, the extra
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>π</mi><annotation encoding="application/x-tex">\pi</annotation></semantics></math>
parameter should not help:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_degpd_on_x</span> <span class="op">&lt;-</span> <span class="va">fit_degpd</span>  <span class="co"># fitted to non-inflated x above</span></span>
<span><span class="va">fit_zi_on_x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitegpd.html">fitegpd</a></span><span class="op">(</span><span class="va">x</span>, type <span class="op">=</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="st">"zidegpd"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"DEGPD AIC:   "</span>, <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fit_degpd_on_x</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; DEGPD AIC:    4920.769</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"ZIDEGPD AIC: "</span>, <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fit_zi_on_x</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ZIDEGPD AIC:  4922.401</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Estimated pi:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_zi_on_x</span><span class="op">$</span><span class="va">estimate</span><span class="op">[</span><span class="st">"pi"</span><span class="op">]</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Estimated pi: 0.0278</span></span></code></pre></div>
<p>The estimated
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>π</mi><annotation encoding="application/x-tex">\pi</annotation></semantics></math>
should be near zero and the ZIDEGPD AIC slightly higher (penalised for
the extra parameter).</p>
</div>
</div>
<div class="section level2">
<h2 id="higher-order-types">4. Higher-order types<a class="anchor" aria-label="anchor" href="#higher-order-types"></a>
</h2>
<p>Types 5 and 6 provide additional flexibility. Type 5 has both
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>δ</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>κ</mi><annotation encoding="application/x-tex">\kappa</annotation></semantics></math>
parameters; Type 6 adds a mixing probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">99</span><span class="op">)</span></span>
<span><span class="va">x5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rdiscegpd.html">rdiscegpd</a></span><span class="op">(</span><span class="fl">1000</span>, sigma <span class="op">=</span> <span class="fl">2</span>, xi <span class="op">=</span> <span class="fl">0.1</span>, delta <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>                 kappa <span class="op">=</span> <span class="fl">1.8</span>, type <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">fit5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitegpd.html">fitegpd</a></span><span class="op">(</span><span class="va">x5</span>, type <span class="op">=</span> <span class="fl">5</span>, family <span class="op">=</span> <span class="st">"degpd"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fitting of the distribution 'degpd' (type 5)</span></span>
<span><span class="co">#&gt; Method: mle</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated parameters:</span></span>
<span><span class="co">#&gt;       Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; sigma  1.63595    0.60546   2.702  0.00689 ** </span></span>
<span><span class="co">#&gt; xi     0.15591    0.03919   3.978 6.94e-05 ***</span></span>
<span><span class="co">#&gt; delta  0.41132    0.97364   0.422  0.67269    </span></span>
<span><span class="co">#&gt; kappa  1.65941    0.15856  10.466  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Convergence:  successful </span></span>
<span><span class="co">#&gt; Loglikelihood:  -2117.78   AIC:  4243.56   BIC:  4263.19 </span></span>
<span><span class="co">#&gt; Number of observations:  1000</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit5</span><span class="op">)</span></span></code></pre></div>
<p><img src="fitegpd-discrete_files/figure-html/type5-plot-1.png" class="r-plt" alt="" width="576"></p>
</div>
<div class="section level2">
<h2 id="compound-poisson-discrete-egpd">5. Compound Poisson-Discrete EGPD<a class="anchor" aria-label="anchor" href="#compound-poisson-discrete-egpd"></a>
</h2>
<div class="section level3">
<h3 id="the-model-2">The model<a class="anchor" aria-label="anchor" href="#the-model-2"></a>
</h3>
<p>The Compound Poisson-Discrete EGPD (<code>family = "cpdegpd"</code>)
models the aggregate sum
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><msub><mi>X</mi><mn>1</mn></msub><mo>+</mo><mi>⋯</mi><mo>+</mo><msub><mi>X</mi><mi>N</mi></msub></mrow><annotation encoding="application/x-tex">S = X_1 + \cdots + X_N</annotation></semantics></math>
where</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>∼</mo><mrow><mi mathvariant="normal">P</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">o</mi><mi mathvariant="normal">n</mi></mrow><mo stretchy="false" form="prefix">(</mo><mi>λ</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">N \sim \mathrm{Poisson}(\lambda)</annotation></semantics></math>
is the random number of events, and</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>X</mi><mi>i</mi></msub><mo>∼</mo><mrow><mi mathvariant="normal">D</mi><mi mathvariant="normal">i</mi><mi mathvariant="normal">s</mi><mi mathvariant="normal">c</mi><mi mathvariant="normal">r</mi><mi mathvariant="normal">e</mi><mi mathvariant="normal">t</mi><mi mathvariant="normal">e</mi><mtext mathvariant="normal">-</mtext><mi mathvariant="normal">E</mi><mi mathvariant="normal">G</mi><mi mathvariant="normal">P</mi><mi mathvariant="normal">D</mi></mrow><mo stretchy="false" form="prefix">(</mo><mi>σ</mi><mo>,</mo><mi>ξ</mi><mo>,</mo><mi>κ</mi><mo>,</mo><mi>…</mi><mo stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">X_i \sim \mathrm{Discrete\text{-}EGPD}(\sigma, \xi, \kappa, \ldots)</annotation></semantics></math>
are i.i.d. non-negative integer severities.</li>
</ul>
<p>Since the individual claims are already integer-valued, the Panjer
recursion computes an <strong>exact</strong> compound distribution on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false" form="prefix">{</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\{0, 1, 2, \ldots\}</annotation></semantics></math>
— no discretization step is needed and there is no bin-width parameter
<code>h</code> to tune (unlike <code>family = "cpegpd"</code>).</p>
</div>
<div class="section level3">
<h3 id="simulating-and-fitting-2">Simulating and fitting<a class="anchor" aria-label="anchor" href="#simulating-and-fitting-2"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sigma_true</span>  <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">xi_true</span>     <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="va">kappa_true</span>  <span class="op">&lt;-</span> <span class="fl">1.5</span></span>
<span><span class="va">lambda_true</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span></span>
<span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rcpdegpd.html">rcpdegpd</a></span><span class="op">(</span><span class="fl">500</span>, sigma <span class="op">=</span> <span class="va">sigma_true</span>, xi <span class="op">=</span> <span class="va">xi_true</span>,</span>
<span>               kappa <span class="op">=</span> <span class="va">kappa_true</span>, lambda <span class="op">=</span> <span class="va">lambda_true</span>, type <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Range:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Range: 0 43</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Mean:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"  Var:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Mean: 7.03   Var: 61.4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Proportion zeros:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">z</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Proportion zeros: 0.214</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html" class="external-link">barplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Simulated CPDEGPD data"</span>,</span>
<span>        xlab <span class="op">=</span> <span class="st">"z"</span>, ylab <span class="op">=</span> <span class="st">"Proportion"</span>, col <span class="op">=</span> <span class="st">"lightblue"</span>, border <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span></span></code></pre></div>
<p><img src="fitegpd-discrete_files/figure-html/cpdegpd-hist-1.png" class="r-plt" alt="" width="576"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_cpdegpd</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitegpd.html">fitegpd</a></span><span class="op">(</span><span class="va">z</span>, type <span class="op">=</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="st">"cpdegpd"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_cpdegpd</span><span class="op">)</span></span>
<span><span class="co">#&gt; Fitting of the distribution 'cpdegpd' (type 1)</span></span>
<span><span class="co">#&gt; Method: mle</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Estimated parameters:</span></span>
<span><span class="co">#&gt;        Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; sigma    2.7440     1.1024   2.489   0.0128 *  </span></span>
<span><span class="co">#&gt; xi       0.1482     0.1137   1.303   0.1924    </span></span>
<span><span class="co">#&gt; kappa    1.6625     1.0139   1.640   0.1011    </span></span>
<span><span class="co">#&gt; lambda   1.7767     0.2376   7.477  7.6e-14 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Convergence:  successful </span></span>
<span><span class="co">#&gt; Loglikelihood:  -1488.58   AIC:  2985.17   BIC:  3002.02 </span></span>
<span><span class="co">#&gt; Number of observations:  500</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="parameter-recovery-2">Parameter recovery<a class="anchor" aria-label="anchor" href="#parameter-recovery-2"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">truth</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>sigma <span class="op">=</span> <span class="va">sigma_true</span>, xi <span class="op">=</span> <span class="va">xi_true</span>,</span>
<span>           kappa <span class="op">=</span> <span class="va">kappa_true</span>, lambda <span class="op">=</span> <span class="va">lambda_true</span><span class="op">)</span></span>
<span><span class="va">est</span> <span class="op">&lt;-</span> <span class="va">fit_cpdegpd</span><span class="op">$</span><span class="va">estimate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>true <span class="op">=</span> <span class="va">truth</span>, estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">est</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>      SE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">fit_cpdegpd</span><span class="op">$</span><span class="va">sd</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        true estimate     SE</span></span>
<span><span class="co">#&gt; sigma   3.0   2.7440 1.1024</span></span>
<span><span class="co">#&gt; xi      0.1   0.1482 0.1137</span></span>
<span><span class="co">#&gt; kappa   1.5   1.6625 1.0139</span></span>
<span><span class="co">#&gt; lambda  2.0   1.7767 0.2376</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="diagnostics-2">Diagnostics<a class="anchor" aria-label="anchor" href="#diagnostics-2"></a>
</h3>
<p>The diagnostic plots use discrete-style panels: a barplot with fitted
PMF points, a step-function CDF, and randomized PIT-based Q-Q and P-P
plots.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_cpdegpd</span><span class="op">)</span></span></code></pre></div>
<p><img src="fitegpd-discrete_files/figure-html/cpdegpd-plot-1.png" class="r-plt" alt="" width="576"></p>
</div>
<div class="section level3">
<h3 id="comparing-with-plain-degpd-on-the-same-data">Comparing with plain DEGPD on the same data<a class="anchor" aria-label="anchor" href="#comparing-with-plain-degpd-on-the-same-data"></a>
</h3>
<p>Since <code>cpdegpd</code> is a compound sum model while
<code>degpd</code> is a single-event model, we can compare their AIC on
the same data to see which fits better:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_degpd_on_z</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitegpd.html">fitegpd</a></span><span class="op">(</span><span class="va">z</span>, type <span class="op">=</span> <span class="fl">1</span>, family <span class="op">=</span> <span class="st">"degpd"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"DEGPD AIC:   "</span>, <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fit_degpd_on_z</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; DEGPD AIC:    2995.597</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"CPDEGPD AIC: "</span>, <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fit_cpdegpd</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; CPDEGPD AIC:  2985.166</span></span></code></pre></div>
<p>The compound model should fit noticeably better when the
data-generating process truly involves random summation.</p>
</div>
</div>
<div class="section level2">
<h2 id="practical-guidelines">6. Practical guidelines<a class="anchor" aria-label="anchor" href="#practical-guidelines"></a>
</h2>
<p><strong>Choosing between DEGPD and ZIDEGPD.</strong> Start with
<code>family = "degpd"</code>. If the diagnostic plots show the model
underestimates the zero probability, refit with
<code>family = "zidegpd"</code> and compare by AIC.</p>
<p><strong>Choosing the type.</strong> Fit several types and compare
AIC. Types 1 and 4 have three parameters and are good defaults. Type 5
(four parameters) and Type 6 (five parameters) offer more flexibility
but need larger samples.</p>
<p><strong>Starting values.</strong> The automatic starting values work
well in most cases. For difficult datasets (e.g. very heavy tails),
supply custom start values via
<code>start = list(sigma = ..., xi = ...)</code>.</p>
<p><strong>Fixed parameters.</strong> Use <code>fix.arg</code> when
external information is available —
e.g. <code>fix.arg = list(xi = 0)</code> for an exponential tail.</p>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<table class="table">
<colgroup>
<col width="17%">
<col width="24%">
<col width="35%">
<col width="22%">
</colgroup>
<thead><tr class="header">
<th>Family</th>
<th>Parameters</th>
<th>Zero mechanism</th>
<th>Use case</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>"degpd"</code></td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>,</mo><mi>ξ</mi></mrow><annotation encoding="application/x-tex">\sigma, \xi</annotation></semantics></math>
+ type-specific</td>
<td>Natural zeros from DEGPD</td>
<td>Standard count data</td>
</tr>
<tr class="even">
<td><code>"zidegpd"</code></td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>,</mo><mi>ξ</mi></mrow><annotation encoding="application/x-tex">\sigma, \xi</annotation></semantics></math>
+ type-specific +
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>π</mi><annotation encoding="application/x-tex">\pi</annotation></semantics></math>
</td>
<td>Extra point mass at zero</td>
<td>Counts with excess zeros</td>
</tr>
<tr class="odd">
<td><code>"cpdegpd"</code></td>
<td>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>σ</mi><mo>,</mo><mi>ξ</mi></mrow><annotation encoding="application/x-tex">\sigma, \xi</annotation></semantics></math>
+ type-specific +
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>λ</mi><annotation encoding="application/x-tex">\lambda</annotation></semantics></math>
</td>
<td>Poisson zero
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">N=0</annotation></semantics></math>)</td>
<td>Aggregate integer sums</td>
</tr>
</tbody>
</table>
<p>All families:</p>
<ul>
<li>Return S3 objects of class <code>"fitegpd"</code> with the same
interface (<code>summary</code>, <code>plot</code>, <code>AIC</code>,
<code>confint</code>, <code>coef</code>, <code>vcov</code>,
<code>logLik</code>)</li>
<li>Support <code>fix.arg</code> for fixing parameters at known
values</li>
<li>Estimate standard errors via the delta method on the Hessian</li>
<li>Provide four-panel diagnostic plots tailored for discrete data (bar
plots for PMF, step functions for CDF, randomized PIT-based Q-Q and P-P
plots)</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Touqeer Ahmad, Simon Frost.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
