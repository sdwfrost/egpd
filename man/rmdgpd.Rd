% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mdgpd.R
\name{rmdgpd}
\alias{rmdgpd}
\title{\[Experimental\] Random generation from the multivariate MDGPD}
\usage{
rmdgpd(n, sigma, xi, lambda, rho, d = 2L)
}
\arguments{
\item{n}{integer; number of observations to generate.}

\item{sigma}{positive numeric; GPD scale parameter (common across dimensions).}

\item{xi}{non-negative numeric; GPD shape parameter. When \code{xi = 0}
the marginals reduce to scaled geometric.}

\item{lambda}{positive numeric; Poisson rate for the generator components.
Controls the spread of the dependence structure.}

\item{rho}{numeric in \[0, 1); equicorrelation of the \code{d}-dimensional
Poisson generator. Higher values give stronger positive dependence:
\code{rho -> 1} gives near-perfect dependence, \code{rho = 0} gives
weakest dependence for the given \code{lambda}.}

\item{d}{integer >= 2; dimension of the multivariate distribution
(default \code{2L}).}
}
\value{
An \code{n} by \code{d} integer matrix with columns
  \code{Y1}, \code{Y2}, \ldots, \code{Yd}.
}
\description{
Generates random samples from the \code{d}-dimensional Multivariate Discrete
Generalized Pareto Distribution (MDGPD) of Aka, Kratz & Naveau (2025).
Uses the generator-based construction with an equicorrelated Poisson
generator and geometric maximum component. This function is pure R and
does not require Julia.
}
\details{
The construction follows Aka, Kratz & Naveau (2025), generalised to
dimension \code{d}:
\enumerate{
  \item Generate \code{d}-dimensional equicorrelated Poisson generator
    \eqn{T_j = X_j + Z} where \eqn{Z \sim Poisson(\rho\lambda)} (common)
    and \eqn{X_j \sim Poisson((1-\rho)\lambda)} (independent), for
    \eqn{j = 1, \ldots, d}.
  \item For each component \eqn{i}, compute the spectral difference
    \eqn{\Delta_i = T_i - \max_{j \neq i} T_j}.
  \item Generate \eqn{G \sim Geometric(1 - e^{-1})}, independently.
  \item Standard MDGPD: \eqn{N_i = G + \min(\Delta_i, 0)}.
  \item Non-standard transform to discrete GPD marginals:
    \eqn{M_i = \lfloor \sigma (e^{\xi \max(N_i, 0)} - 1) / \xi \rfloor}.
}

The parameter \code{rho} controls dependence strength: when \code{rho}
is close to 1, all components tend to be equal. The parameter
\code{lambda} controls the spread of the spectral differences.

For \code{d = 2}, the spectral difference reduces to
\eqn{\Delta = T_1 - T_2} and the construction matches the bivariate
case in the original paper.

This function is \strong{experimental} and its interface may change.
}
\examples{
# Bivariate (default)
Y2 <- rmdgpd(1000, sigma = 2, xi = 0.2, lambda = 1, rho = 0.5)
plot(jitter(Y2[,1]), jitter(Y2[,2]), pch = ".", main = "Bivariate MDGPD")

# Trivariate
Y3 <- rmdgpd(1000, sigma = 2, xi = 0.2, lambda = 1, rho = 0.5, d = 3)
pairs(Y3 + runif(length(Y3), -0.3, 0.3), pch = ".", main = "Trivariate MDGPD")

}
\references{
Aka, S., Kratz, M., and Naveau, P. (2025). Multivariate discrete
generalized Pareto distributions: theory, simulation, and applications
to dry spells. \emph{arXiv preprint} arXiv:2506.19361.
}
\seealso{
\code{\link{rzimdgpd}}, \code{\link{rbdegpd}}
}
