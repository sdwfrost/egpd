% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/coverage.R
\name{predictive_coverage}
\alias{predictive_coverage}
\alias{predictive_coverage.egpd}
\alias{predictive_coverage.gamlss}
\alias{predictive_coverage.bamlss}
\title{Predictive coverage for EGPD models}
\usage{
predictive_coverage(fit, ...)

\method{predictive_coverage}{egpd}(
  fit,
  y,
  newdata = NULL,
  level = 0.95,
  nsim = 2000,
  method = c("parametric", "plug-in"),
  use_shortest = FALSE,
  ...
)

\method{predictive_coverage}{gamlss}(
  fit,
  y,
  newdata = NULL,
  level = 0.95,
  nsim = 2000,
  method = c("parametric", "plug-in"),
  use_shortest = FALSE,
  data_fit = NULL,
  ...
)

\method{predictive_coverage}{bamlss}(
  fit,
  y,
  newdata = NULL,
  level = 0.95,
  nsim = 2000,
  method = c("parametric", "plug-in"),
  use_shortest = FALSE,
  ...
)
}
\arguments{
\item{fit}{a fitted model object (class \code{"egpd"},
\code{"gamlss"}, or \code{"bamlss"})}

\item{...}{additional arguments (currently unused)}

\item{y}{numeric vector of observed responses to evaluate coverage
against}

\item{newdata}{optional data frame of covariate values at which to
compute predictions.  If \code{NULL} (the default), in-sample
predictions are used.}

\item{level}{nominal coverage level (default 0.95)}

\item{nsim}{number of parameter/response simulation draws (default
2000)}

\item{method}{\code{"parametric"} (default) for parameter
uncertainty, or \code{"plug-in"} for fixed-parameter prediction}

\item{use_shortest}{logical: use shortest (HDR) interval for
discrete families instead of equal-tailed?  Default \code{FALSE}.}

\item{data_fit}{(gamlss method only) optional data frame passed as
\code{data} to \code{predictAll()}; needed when the original
fitting data cannot be recovered from the fit object.}
}
\value{
A list with components:
\describe{
  \item{\code{family}}{character string identifying the distribution family}
  \item{\code{method}}{the method used (\code{"parametric"} or \code{"plug-in"})}
  \item{\code{level}}{the nominal coverage level}
  \item{\code{coverage}}{the empirical coverage (proportion of \code{y} falling within the prediction interval)}
  \item{\code{covered}}{logical vector indicating which observations are covered}
  \item{\code{L}}{lower prediction interval bounds}
  \item{\code{U}}{upper prediction interval bounds}
}
}
\description{
Compute simulation-based prediction intervals and their empirical
coverage for fitted EGPD-family models.  Methods are provided for
objects of class \code{"egpd"}, \code{"gamlss"}, and
\code{"bamlss"}.
}
\details{
The algorithm has three steps:
\enumerate{
  \item \strong{Parameter draws.}
    \describe{
      \item{\code{method = "plug-in"}}{Fitted parameters are held
        fixed at their point estimates.}
      \item{\code{method = "parametric"}}{Parameters are perturbed
        on the link scale using normal noise (scaled by standard
        errors) and then back-transformed.  For \code{egpd} fits
        this is a multivariate-normal draw from the joint
        coefficient posterior; for \code{gamlss} fits the
        perturbation is independent across parameters.}
    }
  \item \strong{Response simulation.}
    \code{nsim} responses are drawn at each observation from the
    fitted distribution (using the appropriate \code{r*} function
    from the egpd package).
  \item \strong{Intervals and coverage.}
    Equal-tailed quantile intervals are computed from the simulated
    responses.  For discrete families, \code{use_shortest = TRUE}
    gives the shortest (highest-density-region) interval instead.
}
}
\examples{
\dontrun{
y <- rdiscegpd(500, sigma = 3, xi = 0.15, kappa = 2, type = 1)
df <- data.frame(y = y)

# egpd fit
fit_e <- egpd(list(lsigma = y ~ 1, lxi = ~ 1, lkappa = ~ 1),
              data = df, family = "degpd", degpd.args = list(m = 1))
predictive_coverage(fit_e, y)
}

}
