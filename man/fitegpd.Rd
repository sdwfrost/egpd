% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fitegpd.R
\name{fitegpd}
\alias{fitegpd}
\title{Fit EGPD distribution to data}
\usage{
fitegpd(
  x,
  type = 1,
  family = c("egpd", "degpd", "ziegpd", "zidegpd", "cpegpd"),
  method = c("mle", "bernstein"),
  start = NULL,
  fix.arg = NULL,
  optim.method = "Nelder-Mead",
  hessian = TRUE,
  bernstein.m = 8,
  cpegpd.h = 0.2,
  ...
)
}
\arguments{
\item{x}{numeric vector of observations}

\item{type}{integer 1-6 specifying the G-transformation type}

\item{family}{character: \code{"egpd"}, \code{"degpd"}, \code{"ziegpd"},
\code{"zidegpd"}, or \code{"cpegpd"}}

\item{method}{character: \code{"mle"} or \code{"bernstein"} (Bernstein only
for \code{family="egpd"})}

\item{start}{named list of starting values, or \code{NULL} for automatic}

\item{fix.arg}{named list of fixed parameters (not optimized)}

\item{optim.method}{optimization method passed to \code{\link{optim}}}

\item{hessian}{logical: compute standard errors via Hessian?}

\item{bernstein.m}{integer: Bernstein polynomial degree
(\code{method="bernstein"} only)}

\item{cpegpd.h}{numeric: discretization step size for the Compound
Poisson-EGPD Panjer recursion (\code{family="cpegpd"} only)}

\item{...}{additional arguments passed to \code{\link{optim}}}
}
\value{
An object of class \code{"fitegpd"} with components:
\describe{
  \item{estimate}{named vector of parameter estimates}
  \item{sd}{named vector of standard errors (NA if Hessian not computed)}
  \item{vcov}{variance-covariance matrix on natural scale}
  \item{loglik}{maximized log-likelihood}
  \item{aic}{Akaike information criterion}
  \item{bic}{Bayesian information criterion}
  \item{n}{number of observations}
  \item{npar}{number of estimated parameters}
  \item{data}{the input data vector}
  \item{type}{the G-transformation type}
  \item{family}{the distribution family}
  \item{method}{the fitting method}
  \item{fix.arg}{list of fixed arguments}
  \item{convergence}{convergence code from optim (0 = success)}
  \item{optim}{full optim output}
  \item{call}{the matched call}
  \item{bernstein.m}{Bernstein degree (NULL for method="mle")}
  \item{bernstein.weights}{Bernstein weights (NULL for method="mle")}
  \item{cpegpd.h}{discretization step size (NULL for non-cpegpd families)}
}
}
\description{
Maximum likelihood or Bernstein polynomial fitting of EGPD, discrete EGPD,
zero-inflated EGPD, zero-inflated discrete EGPD, or Compound Poisson-EGPD
distributions.
}
\details{
The following families are supported:
\describe{
  \item{\code{"egpd"}}{Continuous Extended Generalized Pareto Distribution}
  \item{\code{"degpd"}}{Discrete EGPD for non-negative integer data}
  \item{\code{"ziegpd"}}{Zero-inflated continuous EGPD}
  \item{\code{"zidegpd"}}{Zero-inflated discrete EGPD}
  \item{\code{"cpegpd"}}{Compound Poisson-EGPD for aggregated data with
    point mass at zero, fitted via Panjer recursion}
}

For \code{family="cpegpd"}, the model is \eqn{S = X_1 + \cdots + X_N}
where \eqn{N \sim \mathrm{Poisson}(\lambda)} and
\eqn{X_i \sim \mathrm{EGPD}(\sigma, \xi, \kappa, \ldots)}.
The \code{cpegpd.h} argument controls the discretization grid width for the
Panjer recursion; smaller values give better accuracy at higher
computational cost.

The Bernstein method (\code{method="bernstein"}) replaces the parametric
G-transformation with a flexible Bernstein polynomial density, giving a
semiparametric model.
}
\examples{
\dontrun{
# Continuous EGPD
x <- regpd(500, sigma = 2, xi = 0.1, kappa = 1.5, type = 1)
fit <- fitegpd(x, type = 1)
summary(fit)
plot(fit)

# Bernstein EGPD
fit_b <- fitegpd(x, type = 1, method = "bernstein")

# Discrete EGPD
y <- rdiscegpd(500, sigma = 3, xi = 0.1, kappa = 1.5, type = 1)
fit_d <- fitegpd(y, type = 1, family = "degpd")

# Compound Poisson-EGPD
z <- rcpegpd(500, sigma = 2, xi = 0.1, kappa = 1.5, lambda = 2)
fit_cp <- fitegpd(z, type = 1, family = "cpegpd")
}
}
