% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fitegpd.R
\name{fitegpd}
\alias{fitegpd}
\title{Fit EGPD distribution to data}
\usage{
fitegpd(
  x,
  type = 1,
  family = c("egpd", "degpd", "ziegpd", "zidegpd", "cpegpd", "cpdegpd", "begpd",
    "bdegpd", "bzidegpd", "mdgpd", "zimdgpd"),
  method = c("mle", "bernstein", "neuralbayes"),
  start = NULL,
  fix.arg = NULL,
  optim.method = "Nelder-Mead",
  hessian = TRUE,
  bernstein.m = 8,
  cpegpd.h = 0.2,
  model.path = NULL,
  estimator = c("npe", "nbe"),
  nsamples = 1000L,
  ...
)
}
\arguments{
\item{x}{numeric vector of observations (univariate families), or an
n-by-d numeric matrix/data.frame (multivariate families; d=2 for BEGPD,
d >= 2 for MDGPD).}

\item{type}{integer 1-6 specifying the G-transformation type (univariate only).}

\item{family}{character: "egpd", "degpd", "ziegpd", "zidegpd", "cpegpd",
"cpdegpd", "begpd" (bivariate EGPD), "bdegpd" (\[Experimental\] bivariate
discrete EGPD), "bzidegpd" (\[Experimental\] zero-inflated bivariate
discrete EGPD), "mdgpd" (\[Experimental\] multivariate MDGPD via
Aka-Kratz-Naveau construction, d >= 2), or "zimdgpd" (\[Experimental\]
zero-inflated multivariate MDGPD, d >= 2).}

\item{method}{character: "mle", "bernstein", or "neuralbayes".
\code{"neuralbayes"} is required for bivariate families and requires
Julia dependencies.}

\item{start}{named list of starting values, or NULL for automatic
(not used for method="neuralbayes").}

\item{fix.arg}{named list of fixed parameters (not used for method="neuralbayes").}

\item{optim.method}{optimization method passed to \code{\link{optim}}}

\item{hessian}{logical: compute standard errors via Hessian?}

\item{bernstein.m}{integer: Bernstein polynomial degree (method="bernstein" only)}

\item{cpegpd.h}{numeric: discretization step for cpegpd family.}

\item{model.path}{character: path to a pre-trained .bson model file
(method="neuralbayes" only). If NULL, uses bundled model.}

\item{estimator}{character: \code{"npe"} for Neural Posterior Estimation or
\code{"nbe"} for Neural Bayesian Estimation (method="neuralbayes" only).}

\item{nsamples}{integer: number of posterior samples for NPE
(method="neuralbayes" with estimator="npe" only).}

\item{...}{additional arguments passed to \code{\link{optim}}}
}
\value{
An object of class \code{"fitegpd"} with components:
\describe{
  \item{estimate}{named vector of parameter estimates}
  \item{sd}{named vector of standard errors (NA if Hessian not computed)}
  \item{vcov}{variance-covariance matrix on natural scale}
  \item{loglik}{maximized log-likelihood}
  \item{aic}{Akaike information criterion}
  \item{bic}{Bayesian information criterion}
  \item{n}{number of observations}
  \item{npar}{number of estimated parameters}
  \item{data}{the input data vector}
  \item{type}{the G-transformation type}
  \item{family}{the distribution family}
  \item{method}{the fitting method}
  \item{fix.arg}{list of fixed arguments}
  \item{convergence}{convergence code from optim (0 = success)}
  \item{optim}{full optim output}
  \item{call}{the matched call}
  \item{bernstein.m}{Bernstein degree (NULL for method="mle")}
  \item{bernstein.weights}{Bernstein weights (NULL for method="mle")}
}

For \code{family="begpd"}, additional fields:
\describe{
  \item{estimator_type}{"npe" or "nbe"}
  \item{model.path}{path to the .bson model used}
  \item{posterior_samples}{6 x nsamples matrix of posterior draws (NPE) or NULL (NBE)}
  \item{nsamples}{number of posterior samples (NPE) or NULL (NBE)}
}
}
\description{
Maximum likelihood, Bernstein polynomial, or neural Bayes fitting of EGPD,
discrete EGPD, zero-inflated EGPD, zero-inflated discrete EGPD, or
bivariate multivariate EGPD distributions.
}
\examples{
\dontrun{
# Univariate fitting
x <- regpd(500, sigma = 2, xi = 0.1, kappa = 1.5, type = 1)
fit <- fitegpd(x, type = 1)
summary(fit)
plot(fit)

# Bivariate BEGPD (requires Julia)
Y <- rbegpd(1000, kappa = 2, sigma = 1, xi = 0.1, thL = 5, thU = 5, thw = 0.2)
fit_biv <- fitegpd(Y, family = "begpd", method = "neuralbayes")
summary(fit_biv)
plot(fit_biv)
}

}
