% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/begpd.R
\name{train_begpd}
\alias{train_begpd}
\title{Train a neural estimator for bivariate BEGPD}
\usage{
train_begpd(
  savepath = "inst/models",
  estimator = c("both", "npe", "nbe"),
  K = NULL,
  m = NULL,
  epochs = NULL,
  stopping_epochs = 10,
  quick = FALSE,
  mc.cores = parallel::detectCores() - 1L,
  seed = 1L,
  verbose = TRUE
)
}
\arguments{
\item{savepath}{character; directory to save trained model files (.bson).
Created if it does not exist.}

\item{estimator}{character; which estimator(s) to train: \code{"both"}
(default), \code{"npe"}, or \code{"nbe"}.}

\item{K}{integer; number of training parameter sets to sample from the prior.}

\item{m}{integer vector; range of sample sizes for simulated datasets
(e.g., \code{1000:4000}).}

\item{epochs}{integer; maximum number of training epochs.}

\item{stopping_epochs}{integer; early stopping patience (epochs without
improvement).}

\item{quick}{logical; if \code{TRUE}, uses reduced training settings for
quick testing (K=20000, m=500:1000, epochs=10).}

\item{mc.cores}{integer; number of parallel cores for data simulation.
Forced to 1 on Windows.}

\item{seed}{integer or \code{NULL}; random seed for reproducibility.}

\item{verbose}{logical; if \code{TRUE}, print progress messages.}
}
\value{
A named list of file paths to saved .bson model files (invisible).
}
\description{
Trains Neural Posterior Estimator (NPE) and/or Neural Bayesian Estimator
(NBE) networks for bivariate BEGPD inference. Requires Julia (>= 1.11)
with NeuralEstimators.jl and Flux.jl installed, plus the R packages
\pkg{JuliaConnectoR} and \pkg{NeuralEstimators}.
}
\details{
The training procedure:
\enumerate{
  \item Samples parameters from uniform priors.
  \item Simulates bivariate BEGPD data using \code{\link{rbegpd}}.
  \item Applies variance-stabilizing (signed log) and log parameter transforms.
  \item Trains the neural network(s) using \code{NeuralEstimators::train()}.
  \item Saves trained states as .bson files.
}
}
\examples{
\dontrun{
paths <- train_begpd(savepath = tempdir(), quick = TRUE)
}

}
\references{
Sainsbury-Dale, M., Zammit-Mangion, A., and Huser, R. (2024). Likelihood-free
parameter estimation with neural Bayes estimators. \emph{The American
Statistician}, 78(1), 1--14.
}
